title: IDP
author:
    name: Joerg Reichelt
    contact: joerg.reichelt@id.me
contributors:
    - name: Ryan Jacobchick
      contact: ryan.jacobchick@id.me
date: "2024-04-11"
business_criticality: mission-critical
tags_available:
    - aws
    - aws:s3
    - aws:ses
    - aws:sns
    - gcp
    - gems
    - git
    - npm
    - rails
    - ruby
    - slq
data_assets:
    app-dependency-packages:
        id: app-dependency-packages
        title: app dependency packages
        description: app dependency packages
        usage: devops
        origin: devops
        owner: devops
        confidentiality: internal
        integrity: critical
        availability: important
    application-logs:
        id: application-logs
        title: application logs
        description: application logs
        usage: devops
        origin: devops
        owner: devops
        quantity: very-many
        confidentiality: confidential
        integrity: critical
        availability: operational
    application-metrics:
        id: application-metrics
        title: application metrics
        description: application metrics
        usage: devops
        origin: devops
        owner: devops
        quantity: very-many
        confidentiality: internal
        integrity: important
        availability: operational
    application-traces:
        id: application-traces
        title: application traces
        description: captures performance data for hops in communcation paths
        usage: devops
        origin: devops
        owner: devops
        quantity: very-many
        confidentiality: internal
        integrity: operational
        availability: operational
    artifactory-creds:
        id: artifactory-creds
        title: artifactory creds
        description: artifactory creds
        usage: devops
        origin: devops
        owner: devops
        confidentiality: confidential
        integrity: mission-critical
        availability: mission-critical
    asymmetric-keys:
        id: asymmetric-keys
        title: asymmetric keys
        description: hybrid encryption
        origin: partner
        owner: partner
        quantity: few
        integrity: critical
        availability: critical
    authenticator:
        id: authenticator
        title: authenticator
        description: data allowing access to accounts
        origin: member
        owner: member
        quantity: very-many
        confidentiality: strictly-confidential
        integrity: critical
        availability: critical
    chef-creds:
        id: chef-creds
        title: chef creds
        description: chef creds
        usage: devops
        origin: devops
        owner: devops
        confidentiality: confidential
        integrity: important
        availability: important
    cloud-service-provider-creds:
        id: cloud-service-provider-creds
        title: cloud service provider creds
        description: AWS, GCP, ...
        usage: devops
        origin: devops
        owner: devops
        confidentiality: confidential
        integrity: critical
        availability: critical
    configuration:
        id: configuration
        title: configuration
        description: configuration
        usage: devops
        origin: devops
        owner: devops
        confidentiality: confidential
        integrity: critical
        availability: important
    configuration-secrets:
        id: configuration-secrets
        title: configuration secrets
        description: configuration secrets
        usage: devops
        origin: devops
        owner: devops
        confidentiality: confidential
        integrity: critical
        availability: important
    configuration-template:
        id: configuration-template
        title: configuration template
        description: configuration template
        usage: devops
        origin: devops
        owner: devops
        confidentiality: internal
        integrity: critical
        availability: important
    configuration-values:
        id: configuration-values
        title: configuration values
        description: configuration values
        usage: devops
        origin: devops
        owner: devops
        confidentiality: internal
        integrity: critical
        availability: important
    container-image:
        id: container-image
        title: container image
        description: container image
        usage: devops
        origin: devops
        owner: devops
        confidentiality: internal
        integrity: critical
        availability: important
    db-creds:
        id: db-creds
        title: DB creds
        description: DB creds
        usage: devops
        origin: devops
        owner: devops
        confidentiality: confidential
        integrity: critical
        availability: critical
    developer-ssh-keys:
        id: developer-ssh-keys
        title: developer ssh keys
        description: configuration, patching, login to hosts, deployment
        usage: devops
        origin: devops
        owner: devops
        confidentiality: strictly-confidential
        integrity: critical
        availability: important
    encryption-service-creds:
        id: encryption-service-creds
        title: encryption service creds
        description: encryption service creds
        usage: devops
        origin: devops
        owner: devops
        confidentiality: confidential
        integrity: critical
        availability: critical
    feature-flags:
        id: feature-flags
        title: feature flags
        description: feature flags
        usage: devops
        origin: devops
        owner: devops
        quantity: few
        confidentiality: internal
        integrity: critical
        availability: important
    github-creds:
        id: github-creds
        title: github creds
        description: github creds
        usage: devops
        origin: devops
        owner: devops
        confidentiality: internal
        integrity: mission-critical
        availability: important
    honeycomb-creds:
        id: honeycomb-creds
        title: honeycomb creds
        description: monitoring
        usage: devops
        origin: devops
        owner: devops
        confidentiality: confidential
        integrity: important
        availability: important
    idp-consumer-credentials:
        id: idp-consumer-credentials
        title: IDP consumer credentials
        description: OAuth client creds
        origin: business
        owner: partner
        quantity: few
        confidentiality: restricted
        integrity: critical
        availability: critical
    prove-creds:
        id: prove-creds
        title: Prove creds
        description: Prove creds
        usage: devops
        origin: devops
        owner: devops
        confidentiality: confidential
        integrity: mission-critical
        availability: mission-critical
    redis-creds:
        id: redis-creds
        title: redis creds
        description: credentials managed by the platform team (ops) and used by applications or services to talk to other services
        usage: devops
        origin: devops
        owner: devops
        confidentiality: confidential
        integrity: mission-critical
        availability: critical
    security-scan-results:
        id: security-scan-results
        title: security scan results
        description: security scan results
        usage: devops
        origin: devops
        owner: devops
        quantity: few
        confidentiality: internal
        integrity: important
        availability: important
    source-code:
        id: source-code
        title: source code
        description: source code
        usage: devops
        origin: devops
        owner: devops
        confidentiality: internal
        integrity: critical
        availability: important
    telesign-creds:
        id: telesign-creds
        title: Telesign creds
        description: Telesign creds
        usage: devops
        origin: devops
        owner: devops
        confidentiality: confidential
        integrity: mission-critical
        availability: mission-critical
    tenable-creds:
        id: tenable-creds
        title: tenable creds
        description: authenticated scans
        usage: devops
        origin: devops
        owner: devops
        confidentiality: confidential
        integrity: important
        availability: important
    tenable-ssh-keys:
        id: tenable-ssh-keys
        title: tenable ssh keys
        description: tenable ssh keys
        usage: devops
        origin: devops
        owner: devops
        confidentiality: confidential
        integrity: important
        availability: important
    user-account:
        id: user-account
        title: user account
        description: user identity
        origin: member
        owner: member
        quantity: very-many
        confidentiality: strictly-confidential
        integrity: critical
        availability: critical
    user-session:
        id: user-session
        title: user session
        description: information about the current user session
        origin: member
        owner: member
        quantity: very-many
        confidentiality: strictly-confidential
        integrity: mission-critical
        availability: important
    vault-creds:
        id: vault-creds
        title: vault creds
        description: vault creds
        usage: devops
        origin: devops
        owner: devops
        confidentiality: confidential
        integrity: critical
        availability: critical
technical_assets:
    admin:
        id: admin
        title: Admin
        description: internal app, config for IDme components
        usage: devops
        type: process
        size: component
        technologies:
            - name: web-application
              description: A web application
              aliases:
                - web-app
              attributes:
                http_internet_access_ok: true
                less_protected_type: true
                processing_end_user_requests: true
                propagate_identity_to_outgoing_targets: true
                web-application: true
                web_application: true
        machine: container
        redundant: true
        custom_developed_parts: true
        owner: tools
        confidentiality: strictly-confidential
        integrity: mission-critical
        availability: critical
        justification_cia_rating: |-
            integrity: based on IDP
            availability: based on IDP
        tags:
            - gcp
        data_assets_processed:
            - feature-flags
            - user-account
            - idp-consumer-credentials
            - user-session
            - configuration
        data_formats_accepted:
            - json
            - serialization
        communication_links:
            - id: admin>core-db-access
              source_id: admin
              target_id: core-db
              title: Core DB access
              description: Core DB access
              protocol: sql-access-protocol-encrypted
              ip_filtered: true
              authentication: credentials
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - user-account
                - idp-consumer-credentials
              data_assets_received:
                - user-account
                - idp-consumer-credentials
              diagram_tweak_weight: 3
              diagram_tweak_constraint: true
            - id: admin>redis-access
              source_id: admin
              target_id: redis
              title: Redis access
              description: Redis access
              protocol: binary-encrypted
              readonly: true
              authentication: credentials
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - user-session
              data_assets_received:
                - user-session
              diagram_tweak_weight: 3
              diagram_tweak_constraint: true
    admin-nginx:
        id: admin-nginx
        title: Admin nginx
        description: App Layer LB
        type: process
        size: component
        technologies:
            - name: load-balancer
              description: A load balancer directing incoming requests to available internal infrastructure
              aliases:
                - lb
              attributes:
                close_to_high_value_targets_tolerated: true
                frontend_related: true
                load-balancer: true
                no_authentication_required: true
                no_storage_at_rest: true
                propagate_identity_to_outgoing_targets: true
                traffic_forwarding: true
        machine: container
        redundant: true
        owner: platform
        confidentiality: confidential
        integrity: critical
        availability: mission-critical
        justification_cia_rating: 'availability: compromising this asset would severely impact business viability'
        tags:
            - gcp
        data_assets_processed:
            - feature-flags
            - configuration
        communication_links:
            - id: admin-nginx>admin-access
              source_id: admin-nginx
              target_id: admin
              title: Admin access
              description: Admin access
              protocol: https
              vpn: true
              authentication: two-factor
              authorization: end-user-identity-propagation
              usage: devops
              data_assets_sent:
                - feature-flags
                - configuration
              data_assets_received:
                - feature-flags
                - configuration
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
    akamai-reverse-proxy:
        id: akamai-reverse-proxy
        title: Akamai reverse proxy
        description: 'Akamai: filtering, rate limiting, fraud detection'
        size: component
        technologies:
            - name: reverse-proxy
              description: A proxy hiding internal infrastructure from caller making requests. Can also reduce load
              attributes:
                close_to_high_value_targets_tolerated: true
                frontend_related: true
                http_internet_access_ok: true
                no_authentication_required: true
                no_network_segmentation_required: true
                no_storage_at_rest: true
                propagate_identity_to_outgoing_targets: true
                reverse-proxy: true
                traffic_forwarding: true
        internet: true
        redundant: true
        out_of_scope: true
        encryption: transparent
        owner: seceng
        confidentiality: strictly-confidential
        integrity: mission-critical
        availability: mission-critical
        justification_cia_rating: 'availability: compromising this asset would severely impact business viability'
        data_assets_processed:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
            - configuration
        communication_links:
            - id: akamai-reverse-proxy>waf-access
              source_id: akamai-reverse-proxy
              target_id: akamai-waf
              title: WAF access
              description: WAF access
              protocol: https
              data_assets_sent:
                - user-account
                - user-session
                - authenticator
                - idp-consumer-credentials
              data_assets_received:
                - user-account
                - user-session
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
    akamai-waf:
        id: akamai-waf
        title: Akamai WAF
        description: Akamai WAF
        size: component
        technologies:
            - name: waf
              description: Web Application Firewall
              aliases:
                - web-application-firewall
              attributes:
                frontend_related: true
                http_internet_access_ok: true
                no_authentication_required: true
                no_network_segmentation_required: true
                no_storage_at_rest: true
                propagate_identity_to_outgoing_targets: true
                security_control_related: true
                traffic_forwarding: true
                waf: true
        internet: true
        redundant: true
        out_of_scope: true
        encryption: transparent
        owner: seceng
        confidentiality: strictly-confidential
        integrity: mission-critical
        availability: mission-critical
        justification_cia_rating: 'availability: compromising this asset would severely impact business viability'
        data_assets_processed:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
            - configuration
        communication_links:
            - id: akamai-waf>ha-lb-access
              source_id: akamai-waf
              target_id: ha-proxy-lb
              title: HA LB access
              description: HA LB access
              protocol: https
              readonly: true
              data_assets_sent:
                - user-account
                - user-session
                - authenticator
                - idp-consumer-credentials
              data_assets_received:
                - user-account
                - user-session
              diagram_tweak_weight: 3
              diagram_tweak_constraint: true
    artifactory:
        id: artifactory
        title: artifactory
        description: artifactory
        usage: devops
        type: process
        size: component
        technologies:
            - name: artifact-registry
              description: A registry to store build artifacts
              attributes:
                artifact-registry: true
                development_relevant: true
                less_protected_type: true
                may_contain_secrets: true
        machine: container
        out_of_scope: true
        encryption: transparent
        owner: platform
        confidentiality: confidential
        integrity: mission-critical
        availability: mission-critical
        tags:
            - gcp
            - gems
            - npm
        data_assets_processed:
            - artifactory-creds
            - app-dependency-packages
            - container-image
            - configuration
        data_assets_stored:
            - artifactory-creds
            - app-dependency-packages
            - container-image
        data_formats_accepted:
            - json
    consul-kv:
        id: consul-kv
        title: Consul KV
        description: Consul KV
        usage: devops
        type: process
        size: component
        technologies:
            - name: config-management
              description: A key-value store
              attributes:
                backend_related: true
                config-management: true
        machine: container
        owner: platform
        confidentiality: internal
        integrity: mission-critical
        availability: important
        tags:
            - gcp
        data_assets_processed:
            - configuration-values
        data_assets_stored:
            - configuration-values
    core-db:
        id: core-db
        title: Core DB
        description: postgres, ___ for backups and replication
        type: datastore
        size: component
        technologies:
            - name: identity-store-database
              description: Authentication data as database
              aliases:
                - identity-store
              attributes:
                backend_related: true
                identity-store-database: true
                identity_related: true
                identity_store: true
                vulnerable_to_query_injection: true
        machine: virtual
        redundant: true
        encryption: transparent
        owner: platform
        confidentiality: strictly-confidential
        integrity: mission-critical
        availability: mission-critical
        justification_cia_rating: |-
            confidentiality: contains very sensitive member data
            integrity: compromising this asset would severely impact business viability
            availability: compromising this asset would severely impact business viability
        tags:
            - gcp
            - slq
        data_assets_processed:
            - user-account
            - authenticator
            - asymmetric-keys
            - idp-consumer-credentials
            - db-creds
        data_assets_stored:
            - user-account
            - authenticator
            - asymmetric-keys
            - idp-consumer-credentials
            - db-creds
    dev-ops-browser:
        id: dev-ops-browser
        title: DevOps browser
        description: DevOps browser
        usage: devops
        type: process
        size: component
        technologies:
            - name: browser
              description: A web browser
              aliases:
                - web-browser
              attributes:
                browser: true
                client: true
                frontend_related: true
                less_protected_type: true
                propagate_identity_to_outgoing_targets: true
        out_of_scope: true
        used_as_client_by_human: true
        encryption: transparent
        owner: IT
        confidentiality: confidential
        integrity: mission-critical
        availability: important
        justification_cia_rating: 'integrity: user credentials, MFA tokens and methods, possible bypass of recovery methods'
        data_assets_processed:
            - chef-creds
            - application-traces
            - security-scan-results
            - application-logs
            - feature-flags
            - configuration
        data_formats_accepted:
            - json
            - serialization
        communication_links:
            - id: dev-ops-browser>harness-client-access
              source_id: dev-ops-browser
              target_id: harness
              title: Harness client access
              description: Harness client access
              protocol: https
              readonly: true
              authentication: credentials
              authorization: end-user-identity-propagation
              usage: devops
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: dev-ops-browser>honeycomb-admin-user-access
              source_id: dev-ops-browser
              target_id: honeycomb
              title: Honeycomb admin user access
              description: Honeycomb admin user access
              protocol: https
              readonly: true
              authentication: credentials
              authorization: end-user-identity-propagation
              usage: devops
              data_assets_received:
                - application-traces
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: dev-ops-browser>snyk-client-access
              source_id: dev-ops-browser
              target_id: snyk
              title: Snyk client access
              description: Snyk client access
              protocol: https
              readonly: true
              authentication: credentials
              authorization: end-user-identity-propagation
              usage: devops
              data_assets_received:
                - security-scan-results
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: dev-ops-browser>splunk-admin-user-access
              source_id: dev-ops-browser
              target_id: splunk
              title: Splunk admin user access
              description: Splunk admin user access
              protocol: https
              vpn: true
              readonly: true
              authentication: credentials
              authorization: end-user-identity-propagation
              usage: devops
              data_assets_received:
                - application-logs
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: dev-ops-browser>tenable-client-access
              source_id: dev-ops-browser
              target_id: tenable
              title: Tenable client access
              description: Tenable client access
              protocol: https
              readonly: true
              authentication: credentials
              authorization: end-user-identity-propagation
              usage: devops
              data_assets_received:
                - security-scan-results
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: dev-ops-browser>admin-app-access
              source_id: dev-ops-browser
              target_id: admin-nginx
              title: Admin app access
              description: Admin app access
              protocol: https
              readonly: true
              usage: devops
              data_assets_sent:
                - feature-flags
                - configuration
              data_assets_received:
                - feature-flags
                - configuration
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: dev-ops-browser>grafana-admin-user-access
              source_id: dev-ops-browser
              target_id: grafana
              title: Grafana admin user access
              description: Grafana admin user access
              protocol: https
              vpn: true
              readonly: true
              authentication: credentials
              authorization: end-user-identity-propagation
              usage: devops
              data_assets_received:
                - application-logs
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
    encryption-service:
        id: encryption-service
        title: Encryption Service
        description: |-
            PII in core DB and S3 (HP Voltage)
            validte is encryption service is pass-through only or if it stores data directly in S3
        type: process
        size: component
        technologies:
            - name: web-service-rest
              description: A REST web service (API)
              aliases:
                - rest-api
              attributes:
                backend_related: true
                less_protected_type: true
                processing_end_user_requests: true
                propagate_identity_to_outgoing_targets: true
                web-service-rest: true
                web_service: true
        machine: container
        redundant: true
        custom_developed_parts: true
        encryption: transparent
        owner: prodeng
        confidentiality: strictly-confidential
        integrity: mission-critical
        availability: critical
        justification_cia_rating: |-
            confidentiality: hadles very sensitive member data
            integrity: compromising this asset would severely impact business viability
        tags:
            - gcp
        data_assets_processed:
            - encryption-service-creds
            - user-account
        data_assets_stored:
            - encryption-service-creds
        data_formats_accepted:
            - json
    encryption-service-nginx:
        id: encryption-service-nginx
        title: Encryption Service nginx
        description: App Layer LB
        type: process
        size: component
        technologies:
            - name: load-balancer
              description: A load balancer directing incoming requests to available internal infrastructure
              aliases:
                - lb
              attributes:
                close_to_high_value_targets_tolerated: true
                frontend_related: true
                load-balancer: true
                no_authentication_required: true
                no_storage_at_rest: true
                propagate_identity_to_outgoing_targets: true
                traffic_forwarding: true
        machine: container
        redundant: true
        owner: platform
        confidentiality: strictly-confidential
        integrity: critical
        availability: mission-critical
        justification_cia_rating: 'availability: compromising this asset would severely impact business viability'
        tags:
            - gcp
        data_assets_processed:
            - user-account
        communication_links:
            - id: encryption-service-nginx>encryption-service-access
              source_id: encryption-service-nginx
              target_id: encryption-service
              title: Encryption Service access
              description: Encryption Service access
              protocol: https
              readonly: true
              authentication: credentials
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - user-account
              data_assets_received:
                - user-account
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
    git-client:
        id: git-client
        title: git client
        description: git client
        usage: devops
        type: process
        size: component
        technologies:
            - name: devops-client
              description: A client used for DevOps
              attributes:
                client: true
                development_relevant: true
                devops-client: true
                frontend_related: true
                less_protected_type: true
                propagate_identity_to_outgoing_targets: true
        internet: true
        out_of_scope: true
        used_as_client_by_human: true
        encryption: transparent
        owner: appsec
        confidentiality: confidential
        integrity: mission-critical
        availability: important
        justification_cia_rating: 'confidentiality: user creds'
        data_assets_processed:
            - source-code
        communication_links:
            - id: git-client>github-git-client-access
              source_id: git-client
              target_id: github
              title: Github git client access
              description: Github git client access
              protocol: ssh
              authentication: two-factor
              authorization: end-user-identity-propagation
              usage: devops
              data_assets_sent:
                - source-code
              data_assets_received:
                - source-code
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
    github:
        id: github
        title: Github
        description: code, configs, CI control
        usage: devops
        size: component
        technologies:
            - name: sourcecode-repository
              description: Git or similar
              aliases:
                - git
              attributes:
                development_relevant: true
                less_protected_type: true
                may_contain_secrets: true
                sourcecode-repository: true
        internet: true
        multi_tenant: true
        redundant: true
        out_of_scope: true
        owner: platform
        confidentiality: confidential
        integrity: mission-critical
        availability: mission-critical
        tags:
            - git
        data_assets_processed:
            - source-code
            - artifactory-creds
            - configuration-template
            - configuration
        data_assets_stored:
            - source-code
            - artifactory-creds
            - configuration-template
        data_formats_accepted:
            - json
    github-workers:
        id: github-workers
        title: Github Workers
        description: build pipelines
        usage: devops
        type: process
        size: component
        technologies:
            - name: build-pipeline
              description: A software build pipeline
              aliases:
                - ci
                - continuous-integration
              attributes:
                build-pipeline: true
                development_relevant: true
                less_protected_type: true
        machine: container
        redundant: true
        out_of_scope: true
        owner: platform
        confidentiality: confidential
        integrity: mission-critical
        availability: mission-critical
        tags:
            - gcp
        data_assets_processed:
            - source-code
            - artifactory-creds
            - app-dependency-packages
            - container-image
            - configuration
        data_formats_accepted:
            - json
        communication_links:
            - id: github-workers>github-worker-artifactory-access
              source_id: github-workers
              target_id: artifactory
              title: Github Worker Artifactory Access
              description: Github Worker Artifactory Access
              protocol: https
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - app-dependency-packages
              data_assets_received:
                - app-dependency-packages
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: github-workers>github-tool-access
              source_id: github-workers
              target_id: github
              title: Github tool access
              description: Github tool access
              protocol: https
              readonly: true
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_received:
                - source-code
                - configuration
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
    grafana:
        id: grafana
        title: Grafana
        description: metrics
        usage: devops
        type: datastore
        size: component
        technologies:
            - name: monitoring
              description: A monitoring system (SIEM, logs)
              aliases:
                - siem
              attributes:
                close_to_high_value_targets_tolerated: true
                less_protected_type: true
                monitoring: true
                unnecessary_data_tolerated: true
                unprotected_communications_tolerated: true
        machine: container
        redundant: true
        out_of_scope: true
        owner: platform
        confidentiality: internal
        integrity: important
        availability: critical
        tags:
            - gcp
        data_assets_processed:
            - application-metrics
            - application-logs
            - configuration
        data_assets_stored:
            - application-metrics
    ha-proxy-lb:
        id: ha-proxy-lb
        title: HA proxy/LB
        description: Layer 3 routing to clusters
        size: component
        technologies:
            - name: load-balancer
              description: A load balancer directing incoming requests to available internal infrastructure
              aliases:
                - lb
              attributes:
                close_to_high_value_targets_tolerated: true
                frontend_related: true
                load-balancer: true
                no_authentication_required: true
                no_storage_at_rest: true
                propagate_identity_to_outgoing_targets: true
                traffic_forwarding: true
        machine: virtual
        internet: true
        redundant: true
        out_of_scope: true
        owner: platform
        confidentiality: strictly-confidential
        integrity: mission-critical
        availability: mission-critical
        justification_cia_rating: 'availability: compromising this asset would severely impact business viability'
        data_assets_processed:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
        communication_links:
            - id: ha-proxy-lb>idp-app-access
              source_id: ha-proxy-lb
              target_id: idp-nginx
              title: IDP app access
              description: IDP app access
              protocol: https
              readonly: true
              data_assets_sent:
                - user-account
                - user-session
                - authenticator
                - idp-consumer-credentials
              data_assets_received:
                - user-account
                - user-session
              diagram_tweak_weight: 3
              diagram_tweak_constraint: true
    harness:
        id: harness
        title: Harness
        description: CD engine
        usage: devops
        type: process
        size: component
        technologies:
            - name: tool
              description: A specific tool
              aliases:
                - utility
              attributes:
                propagate_identity_to_outgoing_targets: true
                tool: true
        machine: virtual
        redundant: true
        encryption: transparent
        owner: platform
        confidentiality: internal
        integrity: mission-critical
        availability: mission-critical
        tags:
            - gcp
        data_assets_processed:
            - configuration-template
        communication_links:
            - id: harness>harness-nomad-processing
              source_id: harness
              target_id: nomad
              title: Harness Nomad processing
              description: Harness Nomad processing
              protocol: https
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - configuration-template
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: harness>harness-github-access
              source_id: harness
              target_id: github
              title: Harness Github access
              description: Harness Github access
              protocol: https
              readonly: true
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_received:
                - configuration-template
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
    honeycomb:
        id: honeycomb
        title: Honeycomb
        description: traces
        usage: devops
        size: component
        technologies:
            - name: monitoring
              description: A monitoring system (SIEM, logs)
              aliases:
                - siem
              attributes:
                close_to_high_value_targets_tolerated: true
                less_protected_type: true
                monitoring: true
                unnecessary_data_tolerated: true
                unprotected_communications_tolerated: true
        internet: true
        multi_tenant: true
        redundant: true
        out_of_scope: true
        owner: platform
        confidentiality: confidential
        integrity: important
        availability: critical
        tags:
            - gcp
        data_assets_processed:
            - application-traces
            - honeycomb-creds
        data_assets_stored:
            - application-traces
            - honeycomb-creds
    idp:
        id: idp
        title: IDP
        description: IDP
        type: process
        size: application
        technologies:
            - name: web-application
              description: A web application
              aliases:
                - web-app
              attributes:
                http_internet_access_ok: true
                less_protected_type: true
                processing_end_user_requests: true
                propagate_identity_to_outgoing_targets: true
                web-application: true
                web_application: true
        machine: container
        redundant: true
        custom_developed_parts: true
        owner: accounts
        confidentiality: strictly-confidential
        integrity: mission-critical
        availability: mission-critical
        justification_cia_rating: |-
            confidentiality: exposed APIs allow partners to consume restricted information such as SSNs
            availability: compromising this asset would severely impact business viability
        tags:
            - aws:s3
            - gcp
            - rails
            - ruby
        data_assets_processed:
            - cloud-service-provider-creds
            - db-creds
            - encryption-service-creds
            - honeycomb-creds
            - redis-creds
            - configuration
            - user-account
            - authenticator
            - asymmetric-keys
            - idp-consumer-credentials
            - feature-flags
            - application-logs
            - application-metrics
            - application-traces
            - developer-ssh-keys
            - user-session
        data_assets_stored:
            - cloud-service-provider-creds
            - db-creds
            - encryption-service-creds
            - honeycomb-creds
            - redis-creds
            - configuration
        data_formats_accepted:
            - json
            - serialization
        communication_links:
            - id: idp>splunk-log-push
              source_id: idp
              target_id: splunk
              title: Splunk Log Push
              description: Splunk Log Push
              protocol: https
              authentication: credentials
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - application-logs
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: idp>encryption-service-app-access
              source_id: idp
              target_id: encryption-service-nginx
              title: Encryption Service app access
              description: Encryption Service app access
              protocol: https
              readonly: true
              usage: devops
              data_assets_sent:
                - user-account
              data_assets_received:
                - user-account
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: idp>grafana-log-push
              source_id: idp
              target_id: grafana
              title: Grafana Log Push
              description: Grafana Log Push
              protocol: https
              authentication: credentials
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - application-metrics
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: idp>honeycomb-log-push
              source_id: idp
              target_id: honeycomb
              title: Honeycomb Log Push
              description: Honeycomb Log Push
              protocol: https
              authentication: credentials
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - application-traces
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: idp>idp-vault-access
              source_id: idp
              target_id: vault
              title: IDP Vault Access
              description: IDP Vault Access
              protocol: https
              readonly: true
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - developer-ssh-keys
              data_assets_received:
                - developer-ssh-keys
              diagram_tweak_weight: 3
              diagram_tweak_constraint: true
            - id: idp>prove
              source_id: idp
              target_id: prove
              title: Prove
              description: Prove
              protocol: https
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - authenticator
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: idp>ses-access
              source_id: idp
              target_id: ses
              title: SES access
              description: SES access
              protocol: https
              authentication: credentials
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - authenticator
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: idp>core-db-access
              source_id: idp
              target_id: core-db
              title: Core DB access
              description: Core DB access
              protocol: sql-access-protocol-encrypted
              ip_filtered: true
              authentication: credentials
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - user-account
                - idp-consumer-credentials
              data_assets_received:
                - user-account
                - idp-consumer-credentials
              diagram_tweak_weight: 3
              diagram_tweak_constraint: true
            - id: idp>postmark
              source_id: idp
              target_id: postmark
              title: Postmark
              description: Postmark
              protocol: https
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - authenticator
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: idp>redis-access
              source_id: idp
              target_id: redis
              title: Redis access
              description: Redis access
              protocol: binary-encrypted
              readonly: true
              authentication: credentials
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - user-session
              data_assets_received:
                - user-session
              diagram_tweak_weight: 3
              diagram_tweak_constraint: true
            - id: idp>sns-access
              source_id: idp
              target_id: sns
              title: SNS access
              description: SNS access
              protocol: https
              authentication: credentials
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - application-logs
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: idp>telesign
              source_id: idp
              target_id: telesign
              title: Telesign
              description: Telesign
              protocol: https
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - authenticator
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
    idp-nginx:
        id: idp-nginx
        title: IDP nginx
        description: App Layer LB
        type: process
        size: component
        technologies:
            - name: load-balancer
              description: A load balancer directing incoming requests to available internal infrastructure
              aliases:
                - lb
              attributes:
                close_to_high_value_targets_tolerated: true
                frontend_related: true
                load-balancer: true
                no_authentication_required: true
                no_storage_at_rest: true
                propagate_identity_to_outgoing_targets: true
                traffic_forwarding: true
        machine: container
        redundant: true
        owner: platform
        confidentiality: strictly-confidential
        integrity: mission-critical
        availability: mission-critical
        justification_cia_rating: 'availability: compromising this asset would severely impact business viability'
        tags:
            - gcp
        data_assets_processed:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
        communication_links:
            - id: idp-nginx>idp-member-access
              source_id: idp-nginx
              target_id: idp
              title: IDP Member Access
              description: IDP Member Access
              protocol: https
              authentication: two-factor
              authorization: end-user-identity-propagation
              data_assets_sent:
                - user-account
                - user-session
                - authenticator
                - idp-consumer-credentials
              data_assets_received:
                - user-account
                - user-session
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: idp-nginx>idp-partner-access
              source_id: idp-nginx
              target_id: idp
              title: IDP Partner Access
              description: IDP Partner Access
              protocol: https
              authentication: credentials
              authorization: end-user-identity-propagation
              data_assets_sent:
                - user-account
                - user-session
                - authenticator
                - idp-consumer-credentials
              data_assets_received:
                - user-account
                - user-session
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
    member-browser:
        id: member-browser
        title: Member browser
        description: Member browser
        size: component
        technologies:
            - name: browser
              description: A web browser
              aliases:
                - web-browser
              attributes:
                browser: true
                client: true
                frontend_related: true
                less_protected_type: true
                propagate_identity_to_outgoing_targets: true
        internet: true
        out_of_scope: true
        used_as_client_by_human: true
        encryption: transparent
        confidentiality: strictly-confidential
        integrity: mission-critical
        availability: critical
        justification_cia_rating: 'integrity: user credentials, MFA tokens and methods, possible bypass of recovery methods'
        data_assets_processed:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
        data_formats_accepted:
            - json
            - serialization
        communication_links:
            - id: member-browser>reverse-proxy-access
              source_id: member-browser
              target_id: akamai-reverse-proxy
              title: reverse proxy access
              description: reverse proxy access
              protocol: https
              ip_filtered: true
              readonly: true
              data_assets_sent:
                - user-account
                - user-session
                - authenticator
                - idp-consumer-credentials
              data_assets_received:
                - user-account
                - user-session
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
    nomad:
        id: nomad
        title: Nomad
        description: deployment orchestrator
        usage: devops
        type: process
        size: component
        technologies:
            - name: container-platform
              description: A platform for hosting and executing containers
              aliases:
                - container
                - docker
                - kubernetes
              attributes:
                backend_related: true
                container-platform: true
                container_platform: true
        machine: virtual
        redundant: true
        encryption: transparent
        owner: platform
        confidentiality: confidential
        integrity: mission-critical
        availability: mission-critical
        tags:
            - gcp
        data_assets_processed:
            - configuration-template
            - container-image
            - configuration
            - configuration-values
            - configuration-secrets
        data_assets_stored:
            - configuration-template
        communication_links:
            - id: nomad>nomad-secret-pull
              source_id: nomad
              target_id: vault
              title: Nomad secret pull
              description: Nomad secret pull
              protocol: https
              readonly: true
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_received:
                - configuration-secrets
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: nomad>nomad-value-pull
              source_id: nomad
              target_id: consul-kv
              title: Nomad value pull
              description: Nomad value pull
              protocol: https
              readonly: true
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_received:
                - configuration-values
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
    partner-consumer-application:
        id: partner-consumer-application
        title: partner/consumer application
        description: partner/consumer application
        size: application
        technologies:
            - name: client-system
              description: A client system
              aliases:
                - client
              attributes:
                client: true
                client-system: true
                frontend_related: true
                less_protected_type: true
                propagate_identity_to_outgoing_targets: true
        internet: true
        out_of_scope: true
        encryption: transparent
        owner: partner/customer
        confidentiality: strictly-confidential
        integrity: mission-critical
        availability: critical
        data_assets_processed:
            - user-account
            - idp-consumer-credentials
            - asymmetric-keys
            - user-session
            - authenticator
        data_assets_stored:
            - user-account
            - idp-consumer-credentials
            - asymmetric-keys
        data_formats_accepted:
            - json
        communication_links:
            - id: partner-consumer-application>reverse-proxy-access
              source_id: partner-consumer-application
              target_id: akamai-reverse-proxy
              title: reverse proxy access
              description: reverse proxy access
              protocol: https
              ip_filtered: true
              readonly: true
              data_assets_sent:
                - user-account
                - user-session
                - authenticator
                - idp-consumer-credentials
              data_assets_received:
                - user-account
                - user-session
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
    postmark:
        id: postmark
        title: Postmark
        description: email
        usage: devops
        size: component
        technologies:
            - name: web-service-rest
              description: A REST web service (API)
              aliases:
                - rest-api
              attributes:
                backend_related: true
                less_protected_type: true
                processing_end_user_requests: true
                propagate_identity_to_outgoing_targets: true
                web-service-rest: true
                web_service: true
        internet: true
        multi_tenant: true
        redundant: true
        out_of_scope: true
        owner: prodeng
        confidentiality: restricted
        integrity: operational
        availability: operational
        data_assets_processed:
            - authenticator
        data_formats_accepted:
            - json
    prove:
        id: prove
        title: Prove
        description: SMS fallback
        usage: devops
        size: component
        technologies:
            - name: web-service-rest
              description: A REST web service (API)
              aliases:
                - rest-api
              attributes:
                backend_related: true
                less_protected_type: true
                processing_end_user_requests: true
                propagate_identity_to_outgoing_targets: true
                web-service-rest: true
                web_service: true
        internet: true
        multi_tenant: true
        redundant: true
        out_of_scope: true
        owner: prodeng
        confidentiality: strictly-confidential
        integrity: mission-critical
        availability: mission-critical
        data_assets_processed:
            - prove-creds
            - authenticator
        data_assets_stored:
            - prove-creds
            - authenticator
        data_formats_accepted:
            - json
    redis:
        id: redis
        title: Redis
        description: caching, live configs, feature flags, event collections for experiments
        type: datastore
        size: component
        technologies:
            - name: message-queue
              description: A message queue (like MQTT)
              aliases:
                - mq
              attributes:
                backend_related: true
                message-queue: true
                propagate_identity_to_outgoing_targets: true
                storing_end_user_data: true
        machine: virtual
        redundant: true
        owner: platform
        confidentiality: strictly-confidential
        integrity: mission-critical
        availability: mission-critical
        justification_cia_rating: 'availability: compromising this asset would severely impact business viability'
        tags:
            - gcp
        data_assets_processed:
            - user-account
            - user-session
            - redis-creds
            - feature-flags
        data_assets_stored:
            - user-account
            - user-session
            - redis-creds
            - feature-flags
    ses:
        id: ses
        title: SES
        description: emails fallback
        size: component
        technologies:
            - name: mail-server
              description: A Mail server
              aliases:
                - email-server
              attributes:
                less_protected_type: true
                mail-server: true
                storing_end_user_data: true
        redundant: true
        out_of_scope: true
        owner: platform
        confidentiality: strictly-confidential
        integrity: critical
        availability: critical
        tags:
            - aws:ses
        data_assets_processed:
            - cloud-service-provider-creds
            - user-account
            - authenticator
        data_assets_stored:
            - cloud-service-provider-creds
        data_formats_accepted:
            - json
    sns:
        id: sns
        title: SNS
        description: event emitter for experiments, events sent to core DB, ...
        usage: devops
        size: component
        technologies:
            - name: message-queue
              description: A message queue (like MQTT)
              aliases:
                - mq
              attributes:
                backend_related: true
                message-queue: true
                propagate_identity_to_outgoing_targets: true
                storing_end_user_data: true
        redundant: true
        out_of_scope: true
        owner: platform
        confidentiality: strictly-confidential
        integrity: critical
        availability: critical
        tags:
            - aws:sns
        data_assets_processed:
            - cloud-service-provider-creds
            - user-account
            - application-logs
        data_assets_stored:
            - cloud-service-provider-creds
        data_formats_accepted:
            - json
    snyk:
        id: snyk
        title: snyk
        description: sast
        usage: devops
        size: component
        technologies:
            - name: code-inspection-platform
              description: (Static) Code Analysis)
              aliases:
                - code-inspection
                - code-analysis
              attributes:
                code-inspection-platform: true
                development_relevant: true
                less_protected_type: true
        internet: true
        multi_tenant: true
        redundant: true
        out_of_scope: true
        owner: appsec
        confidentiality: confidential
        integrity: mission-critical
        availability: important
        data_assets_processed:
            - github-creds
            - source-code
            - configuration
            - security-scan-results
        data_assets_stored:
            - github-creds
        data_formats_accepted:
            - json
        communication_links:
            - id: snyk>github-tool-access
              source_id: snyk
              target_id: github
              title: Github tool access
              description: Github tool access
              protocol: https
              readonly: true
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_received:
                - source-code
                - configuration
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
    splunk:
        id: splunk
        title: Splunk
        description: log, app logs, sys logs, puma logs, nginx logs
        usage: devops
        type: datastore
        size: component
        technologies:
            - name: monitoring
              description: A monitoring system (SIEM, logs)
              aliases:
                - siem
              attributes:
                close_to_high_value_targets_tolerated: true
                less_protected_type: true
                monitoring: true
                unnecessary_data_tolerated: true
                unprotected_communications_tolerated: true
        machine: virtual
        redundant: true
        out_of_scope: true
        owner: seceng/cyber
        confidentiality: strictly-confidential
        integrity: critical
        availability: critical
        justification_cia_rating: 'confidentiality: some very sensitive data gets logged currently, should scrub it'
        tags:
            - gcp
        data_assets_processed:
            - user-account
            - application-logs
            - configuration
        data_assets_stored:
            - user-account
            - application-logs
        data_formats_accepted:
            - json
    telesign:
        id: telesign
        title: Telesign
        description: SMS
        usage: devops
        size: component
        technologies:
            - name: web-service-rest
              description: A REST web service (API)
              aliases:
                - rest-api
              attributes:
                backend_related: true
                less_protected_type: true
                processing_end_user_requests: true
                propagate_identity_to_outgoing_targets: true
                web-service-rest: true
                web_service: true
        internet: true
        multi_tenant: true
        redundant: true
        out_of_scope: true
        owner: prodeng
        confidentiality: strictly-confidential
        integrity: mission-critical
        availability: mission-critical
        data_assets_processed:
            - telesign-creds
            - authenticator
        data_assets_stored:
            - telesign-creds
        data_formats_accepted:
            - json
    tenable:
        id: tenable
        title: tenable
        description: authenticated scans
        usage: devops
        size: component
        technologies:
            - name: monitoring
              description: A monitoring system (SIEM, logs)
              aliases:
                - siem
              attributes:
                close_to_high_value_targets_tolerated: true
                less_protected_type: true
                monitoring: true
                unnecessary_data_tolerated: true
                unprotected_communications_tolerated: true
        machine: virtual
        out_of_scope: true
        owner: secops
        confidentiality: confidential
        integrity: critical
        availability: important
        tags:
            - aws
        data_assets_processed:
            - application-logs
            - tenable-creds
            - tenable-ssh-keys
            - security-scan-results
        data_assets_stored:
            - application-logs
            - tenable-creds
            - tenable-ssh-keys
            - security-scan-results
        data_formats_accepted:
            - json
        communication_links:
            - id: tenable>tenable-scan
              source_id: tenable
              target_id: tenable-scan-host
              title: Tenable Scan
              description: Tenable Scan
              protocol: ssh
              readonly: true
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - security-scan-results
              data_assets_received:
                - security-scan-results
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
    tenable-scan-host:
        id: tenable-scan-host
        title: tenable scan host
        description: tenable scan host
        usage: devops
        type: process
        size: component
        technologies:
            - name: code-inspection-platform
              description: (Static) Code Analysis)
              aliases:
                - code-inspection
                - code-analysis
              attributes:
                code-inspection-platform: true
                development_relevant: true
                less_protected_type: true
        machine: virtual
        out_of_scope: true
        owner: platform
        confidentiality: internal
        integrity: important
        availability: important
        tags:
            - gcp
        data_assets_processed:
            - security-scan-results
            - configuration
    terraform:
        id: terraform
        title: terraform
        description: terraform
        usage: devops
        type: process
        size: component
        technologies:
            - name: batch-processing
              description: A set of tools automatically processing data
              attributes:
                backend_related: true
                batch-processing: true
        machine: container
        out_of_scope: true
        owner: platform
        confidentiality: strictly-confidential
        integrity: mission-critical
        availability: critical
        tags:
            - gcp
        data_assets_processed:
            - github-creds
            - vault-creds
            - source-code
            - cloud-service-provider-creds
            - configuration
            - developer-ssh-keys
        data_assets_stored:
            - github-creds
            - vault-creds
        data_formats_accepted:
            - json
        communication_links:
            - id: terraform>terraform-configurator-akamai-waf
              source_id: terraform
              target_id: akamai-waf
              title: Terraform Configurator -> akamai-waf
              description: Terraform Configurator -> akamai-waf
              protocol: https
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - configuration
              data_assets_received:
                - configuration
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: terraform>terraform-configurator-artifactory
              source_id: terraform
              target_id: artifactory
              title: Terraform Configurator -> artifactory
              description: Terraform Configurator -> artifactory
              protocol: https
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - configuration
              data_assets_received:
                - configuration
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: terraform>terraform-configurator-vault
              source_id: terraform
              target_id: vault
              title: Terraform Configurator -> vault
              description: Terraform Configurator -> vault
              protocol: https
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - configuration
              data_assets_received:
                - configuration
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: terraform>terraform-infra-manager-grafana
              source_id: terraform
              target_id: grafana
              title: Terraform Infra Manager -> grafana
              description: Terraform Infra Manager -> grafana
              protocol: https
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - configuration
              data_assets_received:
                - configuration
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: terraform>terraform-infra-manager-splunk
              source_id: terraform
              target_id: splunk
              title: Terraform Infra Manager -> splunk
              description: Terraform Infra Manager -> splunk
              protocol: https
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - configuration
              data_assets_received:
                - configuration
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: terraform>terraform-infra-manager-vault
              source_id: terraform
              target_id: vault
              title: Terraform Infra Manager -> vault
              description: Terraform Infra Manager -> vault
              protocol: https
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - configuration
              data_assets_received:
                - configuration
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: terraform>github-tool-access
              source_id: terraform
              target_id: github
              title: Github tool access
              description: Github tool access
              protocol: https
              readonly: true
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_received:
                - source-code
                - configuration
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: terraform>terraform-configurator-akamai-reverse-proxy
              source_id: terraform
              target_id: akamai-reverse-proxy
              title: Terraform Configurator -> akamai-reverse-proxy
              description: Terraform Configurator -> akamai-reverse-proxy
              protocol: https
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - configuration
              data_assets_received:
                - configuration
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: terraform>terraform-configurator-github
              source_id: terraform
              target_id: github
              title: Terraform Configurator -> github
              description: Terraform Configurator -> github
              protocol: https
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - configuration
              data_assets_received:
                - configuration
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: terraform>terraform-infra-manager-artifactory
              source_id: terraform
              target_id: artifactory
              title: Terraform Infra Manager -> artifactory
              description: Terraform Infra Manager -> artifactory
              protocol: https
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - configuration
              data_assets_received:
                - configuration
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: terraform>terraform-infra-manager-github-workers
              source_id: terraform
              target_id: github-workers
              title: Terraform Infra Manager -> github-workers
              description: Terraform Infra Manager -> github-workers
              protocol: https
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - configuration
              data_assets_received:
                - configuration
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: terraform>terraform-infra-manager-tenable-scan-host
              source_id: terraform
              target_id: tenable-scan-host
              title: Terraform Infra Manager -> tenable-scan-host
              description: Terraform Infra Manager -> tenable-scan-host
              protocol: https
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - configuration
              data_assets_received:
                - configuration
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
            - id: terraform>terraform-vault-access
              source_id: terraform
              target_id: vault
              title: Terraform Vault Access
              description: Terraform Vault Access
              protocol: https
              readonly: true
              authentication: token
              authorization: technical-user
              usage: devops
              data_assets_sent:
                - developer-ssh-keys
              data_assets_received:
                - developer-ssh-keys
              diagram_tweak_weight: 1
              diagram_tweak_constraint: true
    vault:
        id: vault
        title: vault
        description: vault
        usage: devops
        type: datastore
        size: component
        technologies:
            - name: vault
              description: Encryption and key management
              aliases:
                - hashicorp-vault
              attributes:
                backend_related: true
                security_control_related: true
                vault: true
        machine: container
        encryption: transparent
        owner: platform
        confidentiality: strictly-confidential
        integrity: mission-critical
        availability: mission-critical
        tags:
            - gcp
        data_assets_processed:
            - vault-creds
            - developer-ssh-keys
            - configuration-secrets
            - configuration
        data_assets_stored:
            - vault-creds
            - developer-ssh-keys
            - configuration-secrets
        data_formats_accepted:
            - json
trust_boundaries:
    admin-boundary:
        id: admin-boundary
        title: Admin Boundary
        description: Admin Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        trust_boundaries_nested:
            - admin-runtime
    admin-runtime:
        id: admin-runtime
        title: Admin Runtime
        description: Admin Runtime
        type: execution-environment
        tags:
            - gcp
        technical_assets_inside:
            - admin-nginx
            - admin
    akamai:
        id: akamai
        title: Akamai
        description: Akamai
        type: network-dedicated-hoster
        technical_assets_inside:
            - akamai-reverse-proxy
            - akamai-waf
    artifactory-boundary:
        id: artifactory-boundary
        title: Artifactory Boundary
        description: Artifactory Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - artifactory
    aws:
        id: aws
        title: AWS
        description: AWS
        type: network-cloud-provider
        tags:
            - aws
        technical_assets_inside:
            - sns
            - ses
            - tenable
    cd-boundary:
        id: cd-boundary
        title: CD Boundary
        description: CD Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - terraform
            - consul-kv
            - nomad
            - harness
    ci-boundary:
        id: ci-boundary
        title: CI Boundary
        description: CI Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - github-workers
    core-db-boundary:
        id: core-db-boundary
        title: Core DB Boundary
        description: Core DB Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - core-db
    encryption-service-boundary:
        id: encryption-service-boundary
        title: Encryption Service Boundary
        description: Encryption Service Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        trust_boundaries_nested:
            - encryption-service-runtime
    encryption-service-runtime:
        id: encryption-service-runtime
        title: Encryption Service Runtime
        description: Encryption Service Runtime
        type: execution-environment
        tags:
            - gcp
        technical_assets_inside:
            - encryption-service-nginx
            - encryption-service
    gcp:
        id: gcp
        title: GCP
        description: GCP
        type: network-cloud-provider
        tags:
            - gcp
        trust_boundaries_nested:
            - gcp-core
            - gcp-dmz
    gcp-core:
        id: gcp-core
        title: GCP Core
        description: GCP Core
        type: network-cloud-security-group
        tags:
            - gcp
        trust_boundaries_nested:
            - idp-boundary
            - core-db-boundary
            - vault-boundary
            - encryption-service-boundary
            - admin-boundary
            - redis-boundary
            - artifactory-boundary
            - metrics-boundary
            - log-boundary
            - scan-boundary
            - ci-boundary
            - cd-boundary
    gcp-dmz:
        id: gcp-dmz
        title: GCP DMZ
        description: GCP DMZ
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - ha-proxy-lb
    id-me-corporate:
        id: id-me-corporate
        title: ID.me corporate
        description: ID.me corporate
        type: network-virtual-lan
        trust_boundaries_nested:
            - gcp
            - id-me-laptop
            - aws
    id-me-laptop:
        id: id-me-laptop
        title: ID.me laptop
        description: ID.me laptop
        type: execution-environment
        technical_assets_inside:
            - git-client
            - dev-ops-browser
    idp-boundary:
        id: idp-boundary
        title: IDP Boundary
        description: IDP Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        trust_boundaries_nested:
            - idp-runtime
    idp-runtime:
        id: idp-runtime
        title: IDP Runtime
        description: IDP Runtime
        type: execution-environment
        tags:
            - gcp
        technical_assets_inside:
            - idp-nginx
            - idp
    log-boundary:
        id: log-boundary
        title: Log Boundary
        description: Log Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - splunk
    metrics-boundary:
        id: metrics-boundary
        title: Metrics Boundary
        description: Metrics Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - grafana
    redis-boundary:
        id: redis-boundary
        title: Redis Boundary
        description: Redis Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - redis
    scan-boundary:
        id: scan-boundary
        title: Scan Boundary
        description: Scan Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - tenable-scan-host
    vault-boundary:
        id: vault-boundary
        title: Vault Boundary
        description: Vault Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - vault
shared_runtimes:
    admin-boundary:
        id: admin-boundary
        title: Admin Boundary
        description: Admin Boundary
        tags:
            - gcp
        technical_assets_running:
            - admin
            - admin-nginx
    encryption-service-boundary:
        id: encryption-service-boundary
        title: Encryption Service Boundary
        description: Encryption Service Boundary
        tags:
            - gcp
        technical_assets_running:
            - encryption-service
            - encryption-service-nginx
    idp-runtime:
        id: idp-runtime
        title: IDP Runtime
        description: IDP Runtime
        tags:
            - gcp
        technical_assets_running:
            - idp
            - idp-nginx
built_in_risk_categories:
    - id: missing-build-infrastructure
      title: Missing Build Infrastructure
      description: The modeled architecture does not contain a build infrastructure (devops-client, sourcecode-repo, build-pipeline, etc.), which might be the risk of a model missing critical assets (and thus not seeing their risks). If the architecture contains custom-developed parts, the pipeline where code gets developed and built needs to be part of the model.
      impact: If this risk is unmitigated, attackers might be able to exploit risks unseen in this threat model due to critical build infrastructure components missing in the model.
      asvs: V1 - Architecture, Design and Threat Modeling Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html
      action: Build Pipeline Hardening
      mitigation: Include the build infrastructure in the model.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: architecture
      stride: tampering
      detection_logic: Models with in-scope custom-developed parts missing in-scope development (code creation) and build infrastructure components (devops-client, sourcecode-repo, build-pipeline, etc.).
      risk_assessment: The risk rating depends on the highest sensitivity of the in-scope assets running custom-developed parts.
      false_positives: Models not having any custom-developed parts can be considered as false positives after individual review.
      model_failure_possible_reason: true
      cwe: 1127
    - id: missing-vault
      title: Missing Vault (Secret Storage)
      description: In order to avoid the risk of secret leakage via config files (when attacked through vulnerabilities being able to read files like Path-Traversal and others), it is best practice to use a separate hardened process with proper authentication, authorization, and audit logging to access config secrets (like credentials, private keys, client certificates, etc.). This component is usually some kind of Vault.
      impact: If this risk is unmitigated, attackers might be able to easier steal config secrets (like credentials, private keys, client certificates, etc.) once a vulnerability to access files is present and exploited.
      asvs: V6 - Stored Cryptography Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html
      action: Vault (Secret Storage)
      mitigation: Consider using a Vault (Secret Storage) to securely store and access config secrets (like credentials, private keys, client certificates, etc.).
      check: GetAttribute a Vault (Secret Storage) in place?
      function: architecture
      stride: information-disclosure
      detection_logic: Models without a Vault (Secret Storage).
      risk_assessment: The risk rating depends on the sensitivity of the technical asset itself and of the data assets processed.
      false_positives: Models where no technical assets have any kind of sensitive config data to protect can be considered as false positives after individual review.
      model_failure_possible_reason: true
      cwe: 522
    - id: missing-vault-isolation
      title: Missing Vault Isolation
      description: Highly sensitive vault assets and their data stores should be isolated from other assets by their own network segmentation trust-boundary (execution-environment boundaries do not count as network isolation).
      impact: If this risk is unmitigated, attackers successfully attacking other components of the system might have an easy path towards highly sensitive vault assets and their data stores, as they are not separated by network segmentation.
      asvs: V1 - Architecture, Design and Threat Modeling Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html
      action: Network Segmentation
      mitigation: Apply a network segmentation trust-boundary around the highly sensitive vault assets and their data stores.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: operations
      stride: elevation-of-privilege
      detection_logic: In-scope vault assets when surrounded by other (not vault-related) assets (without a network trust-boundary in-between). This risk is especially prevalent when other non-vault related assets are within the same execution environment (i.e. same database or same application server).
      risk_assessment: Default is medium impact. The impact is increased to high when the asset missing the trust-boundary protection is rated as strictly-confidential or mission-critical.
      false_positives: When all assets within the network segmentation trust-boundary are hardened and protected to the same extend as if all were vaults with data of highest sensitivity.
      cwe: 1008
    - id: xml-external-entity
      title: XML External Entity (XXE)
      description: When a technical asset accepts data in XML format, XML External Entity (XXE) risks might arise.
      impact: If this risk is unmitigated, attackers might be able to read sensitive files (configuration data, key/credential files, deployment files, business data files, etc.) form the filesystem of affected components and/or access sensitive services or files of other components.
      asvs: V14 - Configuration Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html
      action: XML Parser Hardening
      mitigation: Apply hardening of all XML parser instances in order to stay safe from XML External Entity (XXE) vulnerabilities. When a third-party product is used instead of custom developed software, check if the product applies the proper mitigation and ensure a reasonable patch-level.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: development
      stride: information-disclosure
      detection_logic: In-scope technical assets accepting XML data formats.
      risk_assessment: The risk rating depends on the sensitivity of the technical asset itself and of the data assets processed. Also for cloud-based environments the exploitation impact is at least medium, as cloud backend services can be attacked via SSRF (and XXE vulnerabilities are often also SSRF vulnerabilities).
      false_positives: Fully trusted (i.e. cryptographically signed or similar) XML data can be considered as false positives after individual review.
      cwe: 611
    - id: accidental-secret-leak
      title: Accidental Secret Leak
      description: Sourcecode repositories (including their histories) as well as artifact registries can accidentally contain secrets like checked-in or packaged-in passwords, API tokens, certificates, crypto keys, etc.
      impact: If this risk is unmitigated, attackers which have access to affected sourcecode repositories or artifact registries might find secrets accidentally checked-in.
      asvs: V14 - Configuration Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html
      action: Build Pipeline Hardening
      mitigation: Establish measures preventing accidental check-in or package-in of secrets into sourcecode repositories and artifact registries. This starts by using good .gitignore and .dockerignore files, but does not stop there. See for example tools like <i>"git-secrets" or "Talisman"</i> to have check-in preventive measures for secrets. Consider also to regularly scan your repositories for secrets accidentally checked-in using scanning tools like <i>"gitleaks" or "gitrob"</i>.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: operations
      stride: information-disclosure
      detection_logic: In-scope sourcecode repositories and artifact registries.
      risk_assessment: The risk rating depends on the sensitivity of the technical asset itself and of the data assets processed.
      false_positives: Usually no false positives.
      cwe: 200
    - id: cross-site-request-forgery
      title: Cross-Site Request Forgery (CSRF)
      description: When a web application is accessed via web protocols Cross-Site Request Forgery (CSRF) risks might arise.
      impact: If this risk remains unmitigated, attackers might be able to trick logged-in victim users into unwanted actions within the web application by visiting an attacker controlled web site.
      asvs: V4 - Access Control Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html
      action: CSRF Prevention
      mitigation: Try to use anti-CSRF tokens ot the double-submit patterns (at least for logged-in requests). When your authentication scheme depends on cookies (like session or token cookies), consider marking them with the same-site flag. When a third-party product is used instead of custom developed software, check if the product applies the proper mitigation and ensure a reasonable patch-level.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: development
      detection_logic: In-scope web applications accessed via typical web access protocols.
      risk_assessment: The risk rating depends on the integrity rating of the data sent across the communication link.
      false_positives: Web applications passing the authentication sate via custom headers instead of cookies can eventually be false positives. Also when the web application is not accessed via a browser-like component (i.e not by a human user initiating the request that gets passed through all components until it reaches the web application) this can be considered a false positive.
      cwe: 352
    - id: missing-authentication
      title: Missing Authentication
      description: 'Technical assets (especially multi-tenant systems) should authenticate incoming requests when the asset processes sensitive data. '
      impact: If this risk is unmitigated, attackers might be able to access or modify sensitive data in an unauthenticated way.
      asvs: V2 - Authentication Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html
      action: Authentication of Incoming Requests
      mitigation: Apply an authentication method to the technical asset. To protect highly sensitive data consider the use of two-factor authentication for human users.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: architecture
      stride: elevation-of-privilege
      detection_logic: In-scope technical assets (except load-balancer, reverse-proxy, service-registry, waf, ids, and ips and in-process calls) should authenticate incoming requests when the asset processes sensitive data. This is especially the case for all multi-tenant assets (there even non-sensitive ones).
      risk_assessment: The risk rating (medium or high) depends on the sensitivity of the data sent across the communication link. Monitoring callers are exempted from this risk.
      false_positives: Technical assets which do not process requests regarding functionality or data linked to end-users (customers) can be considered as false positives after individual review.
      cwe: 306
    - id: missing-identity-provider-isolation
      title: Missing Identity Provider Isolation
      description: Highly sensitive identity provider assets and their identity data stores should be isolated from other assets by their own network segmentation trust-boundary (execution-environment boundaries do not count as network isolation).
      impact: If this risk is unmitigated, attackers successfully attacking other components of the system might have an easy path towards highly sensitive identity provider assets and their identity data stores, as they are not separated by network segmentation.
      asvs: V1 - Architecture, Design and Threat Modeling Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html
      action: Network Segmentation
      mitigation: Apply a network segmentation trust-boundary around the highly sensitive identity provider assets and their identity data stores.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: operations
      stride: elevation-of-privilege
      detection_logic: In-scope identity provider assets and their identity data stores when surrounded by other (not identity-related) assets (without a network trust-boundary in-between). This risk is especially prevalent when other non-identity related assets are within the same execution environment (i.e. same database or same application server).
      risk_assessment: Default is high impact. The impact is increased to very-high when the asset missing the trust-boundary protection is rated as strictly-confidential or mission-critical.
      false_positives: When all assets within the network segmentation trust-boundary are hardened and protected to the same extend as if all were identity providers with data of highest sensitivity.
      cwe: 1008
    - id: push-instead-of-pull-deployment
      title: Push instead of Pull Deployment
      description: When comparing push-based vs. pull-based deployments from a security perspective, pull-based deployments improve the overall security of the deployment targets. Every exposed interface of a production system to accept a deployment increases the attack surface of the production system, thus a pull-based approach exposes less attack surface relevant interfaces.
      impact: If this risk is unmitigated, attackers might have more potential target vectors for attacks, as the overall attack surface is unnecessarily increased.
      asvs: V1 - Architecture, Design and Threat Modeling Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html
      action: Build Pipeline Hardening
      mitigation: Try to prefer pull-based deployments (like GitOps scenarios offer) over push-based deployments to reduce the attack surface of the production system.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: architecture
      stride: tampering
      detection_logic: Models with build pipeline components accessing in-scope targets of deployment (in a non-readonly way) which are not build-related components themselves.
      risk_assessment: The risk rating depends on the highest sensitivity of the deployment targets running custom-developed parts.
      false_positives: Communication links that are not deployment paths can be considered as false positives after individual review.
      model_failure_possible_reason: true
      cwe: 1127
    - id: unchecked-deployment
      title: Unchecked Deployment
      description: For each build-pipeline component Unchecked Deployment risks might arise when the build-pipeline does not include established DevSecOps best-practices. DevSecOps best-practices scan as part of CI/CD pipelines for vulnerabilities in source- or byte-code, dependencies, container layers, and dynamically against running test systems. There are several open-source and commercial tools existing in the categories DAST, SAST, and IAST.
      impact: If this risk remains unmitigated, vulnerabilities in custom-developed software or their dependencies might not be identified during continuous deployment cycles.
      asvs: V14 - Configuration Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html
      action: Build Pipeline Hardening
      mitigation: Apply DevSecOps best-practices and use scanning tools to identify vulnerabilities in source- or byte-code,dependencies, container layers, and optionally also via dynamic scans against running test systems.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: architecture
      stride: tampering
      detection_logic: All development-relevant technical assets.
      risk_assessment: The risk rating depends on the highest rating of the technical assets and data assets processed by deployment-receiving targets.
      false_positives: When the build-pipeline does not build any software components it can be considered a false positive after individual review.
      cwe: 1127
    - id: unnecessary-communication-link
      title: Unnecessary Communication Link
      description: When a technical communication link does not send or receive any data assets, this is an indicator for an unnecessary communication link (or for an incomplete model).
      impact: If this risk is unmitigated, attackers might be able to target unnecessary communication links.
      asvs: V1 - Architecture, Design and Threat Modeling Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html
      action: Attack Surface Reduction
      mitigation: Try to avoid using technical communication links that do not send or receive anything.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: architecture
      stride: elevation-of-privilege
      detection_logic: In-scope technical assets' technical communication links not sending or receiving any data assets.
      risk_assessment: low
      false_positives: Usually no false positives as this looks like an incomplete model.
      model_failure_possible_reason: true
      cwe: 1008
    - id: code-backdooring
      title: Code Backdooring
      description: For each build-pipeline component Code Backdooring risks might arise where attackers compromise the build-pipeline in order to let backdoored artifacts be shipped into production. Aside from direct code backdooring this includes backdooring of dependencies and even of more lower-level build infrastructure, like backdooring compilers (similar to what the XcodeGhost malware did) or dependencies.
      impact: If this risk remains unmitigated, attackers might be able to execute code on and completely takeover production environments.
      asvs: V10 - Malicious Code Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html
      action: Build Pipeline Hardening
      mitigation: Reduce the attack surface of backdooring the build pipeline by not directly exposing the build pipeline components on the public internet and also not exposing it in front of unmanaged (out-of-scope) developer clients.Also consider the use of code signing to prevent code modifications.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: operations
      stride: tampering
      detection_logic: In-scope development relevant technical assets which are either accessed by out-of-scope unmanaged developer clients and/or are directly accessed by any kind of internet-located (non-VPN) component or are themselves directly located on the internet.
      risk_assessment: The risk rating depends on the confidentiality and integrity rating of the code being handled and deployed as well as the placement/calling of this technical asset on/from the internet.
      false_positives: When the build-pipeline and sourcecode-repo is not exposed to the internet and considered fully trusted (which implies that all accessing clients are also considered fully trusted in terms of their patch management and applied hardening, which must be equivalent to a managed developer client environment) this can be considered a false positive after individual review.
      cwe: 912
    - id: missing-authentication-second-factor
      title: Missing Two-Factor Authentication (2FA)
      description: Technical assets (especially multi-tenant systems) should authenticate incoming requests with two-factor (2FA) authentication when the asset processes or stores highly sensitive data (in terms of confidentiality, integrity, and availability) and is accessed by humans.
      impact: If this risk is unmitigated, attackers might be able to access or modify highly sensitive data without strong authentication.
      asvs: V2 - Authentication Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Multifactor_Authentication_Cheat_Sheet.html
      action: Authentication with Second Factor (2FA)
      mitigation: Apply an authentication method to the technical asset protecting highly sensitive data via two-factor authentication for human users.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      stride: elevation-of-privilege
      detection_logic: In-scope technical assets (except load-balancer, reverse-proxy, waf, ids, and ips) should authenticate incoming requests via two-factor authentication (2FA) when the asset processes or stores highly sensitive data (in terms of confidentiality, integrity, and availability) and is accessed by a client used by a human user.
      risk_assessment: medium
      false_positives: Technical assets which do not process requests regarding functionality or data linked to end-users (customers) can be considered as false positives after individual review.
      cwe: 308
    - id: missing-identity-propagation
      title: Missing Identity Propagation
      description: Technical assets (especially multi-tenant systems), which usually process data for end users should authorize every request based on the identity of the end user when the data flow is authenticated (i.e. non-public). For DevOps usages at least a technical-user authorization is required.
      impact: If this risk is unmitigated, attackers might be able to access or modify foreign data after a successful compromise of a component within the system due to missing resource-based authorization checks.
      asvs: V4 - Access Control Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html
      action: Identity Propagation and Resource-based Authorization
      mitigation: When processing requests for end users if possible authorize in the backend against the propagated identity of the end user. This can be achieved in passing JWTs or similar tokens and checking them in the backend services. For DevOps usages apply at least a technical-user authorization.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: architecture
      stride: elevation-of-privilege
      detection_logic: In-scope service-like technical assets which usually process data based on end user requests, if authenticated (i.e. non-public), should authorize incoming requests based on the propagated end user identity when their rating is sensitive. This is especially the case for all multi-tenant assets (there even less-sensitive rated ones). DevOps usages are exempted from this risk.
      risk_assessment: The risk rating (medium or high) depends on the confidentiality, integrity, and availability rating of the technical asset.
      false_positives: Technical assets which do not process requests regarding functionality or data linked to end-users (customers) can be considered as false positives after individual review.
      cwe: 284
    - id: unencrypted-communication
      title: Unencrypted Communication
      description: Due to the confidentiality and/or integrity rating of the data assets transferred over the communication link this connection must be encrypted.
      impact: If this risk is unmitigated, network attackers might be able to to eavesdrop on unencrypted sensitive data sent between components.
      asvs: V9 - Communication Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html
      action: Encryption of Communication Links
      mitigation: Apply transport layer encryption to the communication link.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: operations
      stride: information-disclosure
      detection_logic: Unencrypted technical communication links of in-scope technical assets (excluding monitoring traffic as well as local-file-access and in-process-library-call) transferring sensitive data.
      risk_assessment: Depending on the confidentiality rating of the transferred data-assets either medium or high risk.
      false_positives: When all sensitive data sent over the communication link is already fully encrypted on document or data level. Also intra-container/pod communication can be considered false positive when container orchestration platform handles encryption.
      cwe: 319
    - id: unnecessary-data-asset
      title: Unnecessary Data Asset
      description: When a data asset is not processed by any data assets and also not transferred by any communication links, this is an indicator for an unnecessary data asset (or for an incomplete model).
      impact: If this risk is unmitigated, attackers might be able to access unnecessary data assets using other vulnerabilities.
      asvs: V1 - Architecture, Design and Threat Modeling Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html
      action: Attack Surface Reduction
      mitigation: Try to avoid having data assets that are not required/used.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: architecture
      stride: elevation-of-privilege
      detection_logic: Modelled data assets not processed by any data assets and also not transferred by any communication links.
      risk_assessment: low
      false_positives: Usually no false positives as this looks like an incomplete model.
      model_failure_possible_reason: true
      cwe: 1008
    - id: missing-file-validation
      title: Missing File Validation
      description: When a technical asset accepts files, these input files should be strictly validated about filename and type.
      impact: If this risk is unmitigated, attackers might be able to provide malicious files to the application.
      asvs: V12 - File and Resources Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/File_Upload_Cheat_Sheet.html
      action: File Validation
      mitigation: Filter by file extension and discard (if feasible) the name provided. Whitelist the accepted file types and determine the mime-type on the server-side (for example via "Apache Tika" or similar checks). If the file is retrievable by end users and/or backoffice employees, consider performing scans for popular malware (if the files can be retrieved much later than they were uploaded, also apply a fresh malware scan during retrieval to scan with newer signatures of popular malware). Also enforce limits on maximum file size to avoid denial-of-service like scenarios.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: development
      detection_logic: In-scope technical assets with custom-developed code accepting file data formats.
      risk_assessment: The risk rating depends on the sensitivity of the technical asset itself and of the data assets processed.
      false_positives: Fully trusted (i.e. cryptographically signed or similar) files can be considered as false positives after individual review.
      cwe: 434
    - id: missing-hardening
      title: Missing Hardening
      description: Technical assets with a Relative Attacker Attractiveness (RAA) value of 55 % or higher should be explicitly hardened taking best practices and vendor hardening guides into account.
      impact: If this risk remains unmitigated, attackers might be able to easier attack high-value targets.
      asvs: V14 - Configuration Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html
      action: System Hardening
      mitigation: Try to apply all hardening best practices (like CIS benchmarks, OWASP recommendations, vendor recommendations, DevSec Hardening Framework, DBSAT for Oracle databases, and others).
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: operations
      stride: tampering
      detection_logic: In-scope technical assets with RAA values of 55 % or higher. Generally for high-value targets like data stores, application servers, identity providers and ERP systems this limit is reduced to 40 %
      risk_assessment: The risk rating depends on the sensitivity of the data processed in the technical asset.
      false_positives: Usually no false positives.
      cwe: 16
    - id: server-side-request-forgery
      title: Server-Side Request Forgery (SSRF)
      description: 'When a server system (i.e. not a client) is accessing other server systems via typical web protocols Server-Side Request Forgery (SSRF) or Local-File-Inclusion (LFI) or Remote-File-Inclusion (RFI) risks might arise. '
      impact: If this risk is unmitigated, attackers might be able to access sensitive services or files of network-reachable components by modifying outgoing calls of affected components.
      asvs: V12 - File and Resources Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html
      action: SSRF Prevention
      mitigation: Try to avoid constructing the outgoing target URL with caller controllable values. Alternatively use a mapping (whitelist) when accessing outgoing URLs instead of creating them including caller controllable values. When a third-party product is used instead of custom developed software, check if the product applies the proper mitigation and ensure a reasonable patch-level.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: development
      stride: information-disclosure
      detection_logic: In-scope non-client systems accessing (using outgoing communication links) targets with either HTTP or HTTPS protocol.
      risk_assessment: The risk rating (low or medium) depends on the sensitivity of the data assets receivable via web protocols from targets within the same network trust-boundary as well on the sensitivity of the data assets receivable via web protocols from the target asset itself. Also for cloud-based environments the exploitation impact is at least medium, as cloud backend services can be attacked via SSRF.
      false_positives: Servers not sending outgoing web requests can be considered as false positives after review.
      cwe: 918
    - id: unnecessary-data-transfer
      title: Unnecessary Data Transfer
      description: When a technical asset sends or receives data assets, which it neither processes or stores this is an indicator for unnecessarily transferred data (or for an incomplete model). When the unnecessarily transferred data assets are sensitive, this poses an unnecessary risk of an increased attack surface.
      impact: If this risk is unmitigated, attackers might be able to target unnecessarily transferred data.
      asvs: V1 - Architecture, Design and Threat Modeling Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html
      action: Attack Surface Reduction
      mitigation: Try to avoid sending or receiving sensitive data assets which are not required (i.e. neither processed) by the involved technical asset.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: architecture
      stride: elevation-of-privilege
      detection_logic: In-scope technical assets sending or receiving sensitive data assets which are neither processed nor stored by the technical asset are flagged with this risk. The risk rating (low or medium) depends on the confidentiality, integrity, and availability rating of the technical asset. Monitoring data is exempted from this risk.
      risk_assessment: The risk assessment is depending on the confidentiality and integrity rating of the transferred data asset either low or medium.
      false_positives: Technical assets missing the model entries of either processing or storing the mentioned data assets can be considered as false positives (incomplete models) after individual review. These should then be addressed by completing the model so that all necessary data assets are processed by the technical asset involved.
      model_failure_possible_reason: true
      cwe: 1008
    - id: container-platform-escape
      title: Container Platform Escape
      description: Container platforms are especially interesting targets for attackers as they host big parts of a containerized runtime infrastructure. When not configured and operated with security best practices in mind, attackers might exploit a vulnerability inside an container and escape towards the platform as highly privileged users. These scenarios might give attackers capabilities to attack every other container as owning the container platform (via container escape attacks) equals to owning every container.
      impact: If this risk is unmitigated, attackers which have successfully compromised a container (via other vulnerabilities) might be able to deeply persist in the target system by executing code in many deployed containers and the container platform itself.
      asvs: V14 - Configuration Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html
      action: Container Infrastructure Hardening
      mitigation: Apply hardening of all container infrastructures. <p>See for example the <i>CIS-Benchmarks for Docker and Kubernetes</i> as well as the <i>Docker Bench for Security</i> ( <a href="https://github.com/docker/docker-bench-security">https://github.com/docker/docker-bench-security</a> ) or <i>InSpec Checks for Docker and Kubernetes</i> ( <a href="https://github.com/dev-sec/cis-kubernetes-benchmark">https://github.com/dev-sec/cis-docker-benchmark</a> and <a href="https://github.com/dev-sec/cis-kubernetes-benchmark">https://github.com/dev-sec/cis-kubernetes-benchmark</a> ). Use only trusted base images, verify digital signatures and apply image creation best practices. Also consider using Google's <b>Distroless</i> base images or otherwise very small base images. Apply namespace isolation and nod affinity to separate pods from each other in terms of access and nodes the same style as you separate data.
      check: Are recommendations from the linked cheat sheet and referenced ASVS or CSVS chapter applied?
      function: operations
      stride: elevation-of-privilege
      detection_logic: In-scope container platforms.
      risk_assessment: The risk rating depends on the sensitivity of the technical asset itself and of the data assets processed.
      false_positives: Container platforms not running parts of the target architecture can be considered as false positives after individual review.
      cwe: 1008
    - id: mixed-targets-on-shared-runtime
      title: Mixed Targets on Shared Runtime
      description: Different attacker targets (like frontend and backend/datastore components) should not be running on the same shared (underlying) runtime.
      impact: If this risk is unmitigated, attackers successfully attacking other components of the system might have an easy path towards more valuable targets, as they are running on the same shared runtime.
      asvs: V1 - Architecture, Design and Threat Modeling Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html
      action: Runtime Separation
      mitigation: Use separate runtime environments for running different target components or apply similar separation styles to prevent load- or breach-related problems originating from one more attacker-facing asset impacts also the other more critical rated backend/datastore assets.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: operations
      stride: elevation-of-privilege
      detection_logic: Shared runtime running technical assets of different trust-boundaries is at risk. Also mixing backend/datastore with frontend components on the same shared runtime is considered a risk.
      risk_assessment: The risk rating (low or medium) depends on the confidentiality, integrity, and availability rating of the technical asset running on the shared runtime.
      false_positives: When all assets running on the shared runtime are hardened and protected to the same extend as if all were containing/processing highly sensitive data.
      cwe: 1008
    - id: path-traversal
      title: Path-Traversal
      description: When a filesystem is accessed Path-Traversal or Local-File-Inclusion (LFI) risks might arise. The risk rating depends on the sensitivity of the technical asset itself and of the data assets processed.
      impact: If this risk is unmitigated, attackers might be able to read sensitive files (configuration data, key/credential files, deployment files, business data files, etc.) from the filesystem of affected components.
      asvs: V12 - File and Resources Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html
      action: Path-Traversal Prevention
      mitigation: Before accessing the file cross-check that it resides in the expected folder and is of the expected type and filename/suffix. Try to use a mapping if possible instead of directly accessing by a filename which is (partly or fully) provided by the caller. When a third-party product is used instead of custom developed software, check if the product applies the proper mitigation and ensure a reasonable patch-level.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: development
      stride: information-disclosure
      detection_logic: Filesystems accessed by in-scope callers.
      risk_assessment: The risk rating depends on the sensitivity of the data stored inside the technical asset.
      false_positives: File accesses by filenames not consisting of parts controllable by the caller can be considered as false positives after individual review.
      cwe: 22
    - id: unguarded-direct-datastore-access
      title: Unguarded Direct Datastore Access
      description: Data stores accessed across trust boundaries must be guarded by some protecting service or application.
      impact: If this risk is unmitigated, attackers might be able to directly attack sensitive data stores without any protecting components in-between.
      asvs: V1 - Architecture, Design and Threat Modeling Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html
      action: Encapsulation of Datastore
      mitigation: Encapsulate the datastore access behind a guarding service or application.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: architecture
      stride: elevation-of-privilege
      detection_logic: In-scope technical assets of type datastore (except identity-store-ldap when accessed from identity-provider and file-server when accessed via file transfer protocols) with confidentiality rating of confidential (or higher) or with integrity rating of critical (or higher) which have incoming data-flows from assets outside across a network trust-boundary. DevOps config and deployment access is excluded from this risk.
      risk_assessment: The matching technical assets are at low risk. When either the confidentiality rating is strictly-confidential or the integrity rating is mission-critical, the risk-rating is considered medium. For assets with RAA values higher than 40 % the risk-rating increases.
      false_positives: When the caller is considered fully trusted as if it was part of the datastore itself.
      cwe: 501
    - id: container-baseimage-backdooring
      title: Container Base Image Backdooring
      description: 'When a technical asset is built using container technologies, Base Image Backdooring risks might arise where base images and other layers used contain vulnerable components or backdoors.<br><br>See for example: <a href="https://techcrunch.com/2018/06/15/tainted-crypto-mining-containers-pulled-from-docker-hub/">https://techcrunch.com/2018/06/15/tainted-crypto-mining-containers-pulled-from-docker-hub/</a>'
      impact: If this risk is unmitigated, attackers might be able to deeply persist in the target system by executing code in deployed containers.
      asvs: V10 - Malicious Code Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html
      action: Container Infrastructure Hardening
      mitigation: Apply hardening of all container infrastructures (see for example the <i>CIS-Benchmarks for Docker and Kubernetes</i> and the <i>Docker Bench for Security</i>). Use only trusted base images of the original vendors, verify digital signatures and apply image creation best practices. Also consider using Google's <i>Distroless</i> base images or otherwise very small base images. Regularly execute container image scans with tools checking the layers for vulnerable components.
      check: Are recommendations from the linked cheat sheet and referenced ASVS/CSVS applied?
      function: operations
      stride: tampering
      detection_logic: In-scope technical assets running as containers.
      risk_assessment: The risk rating depends on the sensitivity of the technical asset itself and of the data assets.
      false_positives: Fully trusted (i.e. reviewed and cryptographically signed or similar) base images of containers can be considered as false positives after individual review.
      cwe: 912
    - id: dos-risky-access-across-trust-boundary
      title: DoS-risky Access Across Trust-Boundary
      description: Assets accessed across trust boundaries with critical or mission-critical availability rating are more prone to Denial-of-Service (DoS) risks.
      impact: If this risk remains unmitigated, attackers might be able to disturb the availability of important parts of the system.
      asvs: V1 - Architecture, Design and Threat Modeling Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html
      action: Anti-DoS Measures
      mitigation: Apply anti-DoS techniques like throttling and/or per-client load blocking with quotas. Also for maintenance access routes consider applying a VPN instead of public reachable interfaces. Generally applying redundancy on the targeted technical asset reduces the risk of DoS.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: operations
      stride: denial-of-service
      detection_logic: In-scope technical assets (excluding load-balancer) with availability rating of critical or higher which have incoming data-flows across a network trust-boundary (excluding devops usage).
      risk_assessment: Matching technical assets with availability rating of critical or higher are at low risk. When the availability rating is mission-critical and neither a VPN nor IP filter for the incoming data-flow nor redundancy for the asset is applied, the risk-rating is considered medium.
      false_positives: When the accessed target operations are not time- or resource-consuming.
      cwe: 400
    - id: missing-identity-store
      title: Missing Identity Store
      description: The modeled architecture does not contain an identity store, which might be the risk of a model missing critical assets (and thus not seeing their risks).
      impact: If this risk is unmitigated, attackers might be able to exploit risks unseen in this threat model in the identity provider/store that is currently missing in the model.
      asvs: V2 - Authentication Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html
      action: Identity Store
      mitigation: Include an identity store in the model if the application has a login.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: architecture
      detection_logic: Models with authenticated data-flows authorized via end user identity missing an in-scope identity store.
      risk_assessment: The risk rating depends on the sensitivity of the end user-identity authorized technical assets and their data assets processed.
      false_positives: Models only offering data/services without any real authentication need can be considered as false positives after individual review.
      model_failure_possible_reason: true
      cwe: 287
    - id: unnecessary-technical-asset
      title: Unnecessary Technical Asset
      description: When a technical asset does not process any data assets, this is an indicator for an unnecessary technical asset (or for an incomplete model). This is also the case if the asset has no communication links (either outgoing or incoming).
      impact: If this risk is unmitigated, attackers might be able to target unnecessary technical assets.
      asvs: V1 - Architecture, Design and Threat Modeling Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html
      action: Attack Surface Reduction
      mitigation: Try to avoid using technical assets that do not process or store anything.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: architecture
      stride: elevation-of-privilege
      detection_logic: Technical assets not processing or storing any data assets.
      risk_assessment: low
      false_positives: Usually no false positives as this looks like an incomplete model.
      model_failure_possible_reason: true
      cwe: 1008
    - id: untrusted-deserialization
      title: Untrusted Deserialization
      description: When a technical asset accepts data in a specific serialized form (like Java or .NET serialization), Untrusted Deserialization risks might arise.<br><br>See <a href="https://christian-schneider.net/JavaDeserializationSecurityFAQ.html">https://christian-schneider.net/JavaDeserializationSecurityFAQ.html</a> for more details.
      impact: If this risk is unmitigated, attackers might be able to execute code on target systems by exploiting untrusted deserialization endpoints.
      asvs: V5 - Validation, Sanitization and Encoding Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html
      action: Prevention of Deserialization of Untrusted Data
      mitigation: Try to avoid the deserialization of untrusted data (even of data within the same trust-boundary as long as it is sent across a remote connection) in order to stay safe from Untrusted Deserialization vulnerabilities. Alternatively a strict whitelisting approach of the classes/types/values to deserialize might help as well. When a third-party product is used instead of custom developed software, check if the product applies the proper mitigation and ensure a reasonable patch-level.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: architecture
      stride: tampering
      detection_logic: In-scope technical assets accepting serialization data formats (including EJB and RMI protocols).
      risk_assessment: The risk rating depends on the sensitivity of the technical asset itself and of the data assets processed.
      false_positives: Fully trusted (i.e. cryptographically signed or similar) data deserialized can be considered as false positives after individual review.
      cwe: 502
    - id: wrong-trust-boundary-content
      title: Wrong Trust Boundary Content
      description: When a trust boundary of type network-policy-namespace-isolation contains non-container assets it is likely to be a model failure.
      impact: If this potential model error is not fixed, some risks might not be visible.
      asvs: V1 - Architecture, Design and Threat Modeling Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Threat_Modeling_Cheat_Sheet.html
      action: Model Consistency
      mitigation: Try to model the correct types of trust boundaries and data assets.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: architecture
      stride: elevation-of-privilege
      detection_logic: Trust boundaries which should only contain containers, but have different assets inside.
      risk_assessment: low
      false_positives: Usually no false positives as this looks like an incomplete model.
      model_failure_possible_reason: true
      cwe: 1008
    - id: cross-site-scripting
      title: Cross-Site Scripting (XSS)
      description: For each web application Cross-Site Scripting (XSS) risks might arise. In terms of the overall risk level take other applications running on the same domain into account as well.
      impact: If this risk remains unmitigated, attackers might be able to access individual victim sessions and steal or modify user data.
      asvs: V5 - Validation, Sanitization and Encoding Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html
      action: XSS Prevention
      mitigation: Try to encode all values sent back to the browser and also handle DOM-manipulations in a safe way to avoid DOM-based XSS. When a third-party product is used instead of custom developed software, check if the product applies the proper mitigation and ensure a reasonable patch-level.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: development
      stride: tampering
      detection_logic: In-scope web applications.
      risk_assessment: The risk rating depends on the sensitivity of the data processed in the web application.
      false_positives: When the technical asset is not accessed via a browser-like component (i.e not by a human user initiating the request that gets passed through all components until it reaches the web application) this can be considered a false positive.
      cwe: 79
    - id: incomplete-model
      title: Incomplete Model
      description: When the threat model contains unknown technologies or transfers data over unknown protocols, this is an indicator for an incomplete model.
      impact: If this risk is unmitigated, other risks might not be noticed as the model is incomplete.
      asvs: V1 - Architecture, Design and Threat Modeling Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Threat_Modeling_Cheat_Sheet.html
      action: Threat Modeling Completeness
      mitigation: Try to find out what technology or protocol is used instead of specifying that it is unknown.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: architecture
      stride: information-disclosure
      detection_logic: All technical assets and communication links with technology type or protocol type specified as unknown.
      risk_assessment: low
      false_positives: Usually no false positives as this looks like an incomplete model.
      model_failure_possible_reason: true
      cwe: 1008
    - id: unguarded-access-from-internet
      title: Unguarded Access From Internet
      description: Internet-exposed assets must be guarded by a protecting service, application, or reverse-proxy.
      impact: If this risk is unmitigated, attackers might be able to directly attack sensitive systems without any hardening components in-between due to them being directly exposed on the internet.
      asvs: V1 - Architecture, Design and Threat Modeling Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html
      action: Encapsulation of Technical Asset
      mitigation: Encapsulate the asset behind a guarding service, application, or reverse-proxy. For admin maintenance a bastion-host should be used as a jump-server. For file transfer a store-and-forward-host should be used as an indirect file exchange platform.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: architecture
      stride: elevation-of-privilege
      detection_logic: In-scope technical assets (excluding load-balancer) with confidentiality rating of confidential (or higher) or with integrity rating of critical (or higher) when accessed directly from the internet. All web-server, web-application, reverse-proxy, waf, and gateway assets are exempted from this risk when they do not consist of custom developed code and the data-flow only consists of HTTP or FTP protocols. Access from monitoring systems as well as VPN-protected connections are exempted.
      risk_assessment: The matching technical assets are at low risk. When either the confidentiality rating is strictly-confidential or the integrity rating is mission-critical, the risk-rating is considered medium. For assets with RAA values higher than 40 % the risk-rating increases.
      false_positives: When other means of filtering client requests are applied equivalent of reverse-proxy, waf, or gateway components.
      cwe: 501
    - id: ldap-injection
      title: LDAP-Injection
      description: When an LDAP server is accessed LDAP-Injection risks might arise. The risk rating depends on the sensitivity of the LDAP server itself and of the data assets processed.
      impact: If this risk remains unmitigated, attackers might be able to modify LDAP queries and access more data from the LDAP server than allowed.
      asvs: V5 - Validation, Sanitization and Encoding Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/LDAP_Injection_Prevention_Cheat_Sheet.html
      action: LDAP-Injection Prevention
      mitigation: Try to use libraries that properly encode LDAP meta characters in searches and queries to access the LDAP sever in order to stay safe from LDAP-Injection vulnerabilities. When a third-party product is used instead of custom developed software, check if the product applies the proper mitigation and ensure a reasonable patch-level.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: development
      stride: tampering
      detection_logic: In-scope clients accessing LDAP servers via typical LDAP access protocols.
      risk_assessment: The risk rating depends on the sensitivity of the LDAP server itself and of the data assets processed.
      false_positives: LDAP server queries by search values not consisting of parts controllable by the caller can be considered as false positives after individual review.
      cwe: 90
    - id: missing-waf
      title: Missing Web Application Firewall (WAF)
      description: To have a first line of filtering defense, security architectures with web-services or web-applications should include a WAF in front of them. Even though a WAF is not a replacement for security (all components must be secure even without a WAF) it adds another layer of defense to the overall system by delaying some attacks and having easier attack alerting through it.
      impact: If this risk is unmitigated, attackers might be able to apply standard attack pattern tests at great speed without any filtering.
      asvs: V1 - Architecture, Design and Threat Modeling Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Virtual_Patching_Cheat_Sheet.html
      action: Web Application Firewall (WAF)
      mitigation: Consider placing a Web Application Firewall (WAF) in front of the web-services and/or web-applications. For cloud environments many cloud providers offer pre-configured WAFs. Even reverse proxies can be enhances by a WAF component via ModSecurity plugins.
      check: GetAttribute a Web Application Firewall (WAF) in place?
      function: operations
      stride: tampering
      detection_logic: In-scope web-services and/or web-applications accessed across a network trust boundary not having a Web Application Firewall (WAF) in front of them.
      risk_assessment: The risk rating depends on the sensitivity of the technical asset itself and of the data assets processed.
      false_positives: Targets only accessible via WAFs or reverse proxies containing a WAF component (like ModSecurity) can be considered as false positives after individual review.
      cwe: 1008
    - id: service-registry-poisoning
      title: Service Registry Poisoning
      description: When a service registry used for discovery of trusted service endpoints Service Registry Poisoning risks might arise.
      impact: If this risk remains unmitigated, attackers might be able to poison the service registry with malicious service endpoints or malicious lookup and config data leading to breach of sensitive data.
      asvs: V10 - Malicious Code Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html
      action: Service Registry Integrity Check
      mitigation: Try to strengthen the access control of the service registry and apply cross-checks to detect maliciously poisoned lookup data.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: architecture
      detection_logic: In-scope service registries.
      risk_assessment: The risk rating depends on the sensitivity of the technical assets accessing the service registry as well as the data assets processed.
      false_positives: Service registries not used for service discovery can be considered as false positives after individual review.
      cwe: 693
    - id: sql-nosql-injection
      title: SQL/NoSQL-Injection
      description: When a database is accessed via database access protocols SQL/NoSQL-Injection risks might arise. The risk rating depends on the sensitivity technical asset itself and of the data assets processed.
      impact: If this risk is unmitigated, attackers might be able to modify SQL/NoSQL queries to steal and modify data and eventually further escalate towards a deeper system penetration via code executions.
      asvs: V5 - Validation, Sanitization and Encoding Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html
      action: SQL/NoSQL-Injection Prevention
      mitigation: Try to use parameter binding to be safe from injection vulnerabilities. When a third-party product is used instead of custom developed software, check if the product applies the proper mitigation and ensure a reasonable patch-level.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: development
      stride: tampering
      detection_logic: Database accessed via typical database access protocols by in-scope clients.
      risk_assessment: The risk rating depends on the sensitivity of the data stored inside the database.
      false_positives: Database accesses by queries not consisting of parts controllable by the caller can be considered as false positives after individual review.
      cwe: 89
    - id: unencrypted-asset
      title: Unencrypted Technical Assets
      description: Due to the confidentiality rating of the technical asset itself and/or the stored data assets this technical asset must be encrypted. The risk rating depends on the sensitivity technical asset itself and of the data assets stored.
      impact: If this risk is unmitigated, attackers might be able to access unencrypted data when successfully compromising sensitive components.
      asvs: V6 - Stored Cryptography Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html
      action: Encryption of Technical Asset
      mitigation: Apply encryption to the technical asset.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: operations
      stride: information-disclosure
      detection_logic: In-scope unencrypted technical assets (excluding reverse-proxy, load-balancer, waf, ids, ips and embedded components like library) storing data assets rated at least as confidential or critical. For technical assets storing data assets rated as strictly-confidential or mission-critical the encryption must be of type data-with-end-user-individual-key.
      risk_assessment: Depending on the confidentiality rating of the stored data-assets either medium or high risk.
      false_positives: When all sensitive data stored within the asset is already fully encrypted on document or data level.
      cwe: 311
    - id: wrong-communication-link-content
      title: Wrong Communication Link Content
      description: When a communication link is defined as readonly, but does not receive any data asset, or when it is defined as not readonly, but does not send any data asset, it is likely to be a model failure.
      impact: If this potential model error is not fixed, some risks might not be visible.
      asvs: V1 - Architecture, Design and Threat Modeling Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Threat_Modeling_Cheat_Sheet.html
      action: Model Consistency
      mitigation: Try to model the correct readonly flag and/or data sent/received of communication links. Also try to use  communication link types matching the target technology/machine types.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: architecture
      stride: information-disclosure
      detection_logic: Communication links with inconsistent data assets being sent/received not matching their readonly flag or otherwise inconsistent protocols not matching the target technology type.
      risk_assessment: low
      false_positives: Usually no false positives as this looks like an incomplete model.
      model_failure_possible_reason: true
      cwe: 1008
    - id: missing-cloud-hardening
      title: Missing Cloud Hardening
      description: Cloud components should be hardened according to the cloud vendor best practices. This affects their configuration, auditing, and further areas.
      impact: If this risk is unmitigated, attackers might access cloud components in an unintended way.
      asvs: V1 - Architecture, Design and Threat Modeling Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html
      action: Cloud Hardening
      mitigation: 'Apply hardening of all cloud components and services, taking special care to follow the individual risk descriptions (which depend on the cloud provider tags in the model). <br><br>For <b>Amazon Web Services (AWS)</b>: Follow the <i>CIS Benchmark for Amazon Web Services</i> (see also the automated checks of cloud audit tools like <i>"PacBot", "CloudSploit", "CloudMapper", "ScoutSuite", or "Prowler AWS CIS Benchmark Tool"</i>). <br>For EC2 and other servers running Amazon Linux, follow the <i>CIS Benchmark for Amazon Linux</i> and switch to IMDSv2. <br>For S3 buckets follow the <i>Security Best Practices for Amazon S3</i> at <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html">https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html</a> to avoid accidental leakage. <br>Also take a look at some of these tools: <a href="https://github.com/toniblyx/my-arsenal-of-aws-security-tools">https://github.com/toniblyx/my-arsenal-of-aws-security-tools</a> <br><br>For <b>Microsoft Azure</b>: Follow the <i>CIS Benchmark for Microsoft Azure</i> (see also the automated checks of cloud audit tools like <i>"CloudSploit" or "ScoutSuite"</i>).<br><br>For <b>Google Cloud Platform</b>: Follow the <i>CIS Benchmark for Google Cloud Computing Platform</i> (see also the automated checks of cloud audit tools like <i>"CloudSploit" or "ScoutSuite"</i>). <br><br>For <b>Oracle Cloud Platform</b>: Follow the hardening best practices (see also the automated checks of cloud audit tools like <i>"CloudSploit"</i>).'
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: operations
      stride: tampering
      detection_logic: In-scope cloud components (either residing in cloud trust boundaries or more specifically tagged with cloud provider types).
      risk_assessment: The risk rating depends on the sensitivity of the technical asset itself and of the data assets processed.
      false_positives: Cloud components not running parts of the target architecture can be considered as false positives after individual review.
      cwe: 1008
    - id: missing-network-segmentation
      title: Missing Network Segmentation
      description: Highly sensitive assets and/or data stores residing in the same network segment than other lower sensitive assets (like webservers or content management systems etc.) should be better protected by a network segmentation trust-boundary.
      impact: If this risk is unmitigated, attackers successfully attacking other components of the system might have an easy path towards more valuable targets, as they are not separated by network segmentation.
      asvs: V1 - Architecture, Design and Threat Modeling Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html
      action: Network Segmentation
      mitigation: Apply a network segmentation trust-boundary around the highly sensitive assets and/or data stores.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: operations
      stride: elevation-of-privilege
      detection_logic: In-scope technical assets with high sensitivity and RAA values as well as data stores when surrounded by assets (without a network trust-boundary in-between) which are of type client-system, web-server, web-application, cms, web-service-rest, web-service-soap, build-pipeline, sourcecode-repository, monitoring, or similar and there is no direct connection between these (hence no requirement to be so close to each other).
      risk_assessment: Default is low risk. The risk is increased to medium when the asset missing the trust-boundary protection is rated as strictly-confidential or mission-critical.
      false_positives: When all assets within the network segmentation trust-boundary are hardened and protected to the same extend as if all were containing/processing highly sensitive data.
      cwe: 1008
    - id: search-query-injection
      title: Search-Query Injection
      description: When a search engine server is accessed Search-Query Injection risks might arise.<br><br>See for example <a href="https://github.com/veracode-research/solr-injection">https://github.com/veracode-research/solr-injection</a> and <a href="https://github.com/veracode-research/solr-injection/blob/master/slides/DEFCON-27-Michael-Stepankin-Apache-Solr-Injection.pdf">https://github.com/veracode-research/solr-injection/blob/master/slides/DEFCON-27-Michael-Stepankin-Apache-Solr-Injection.pdf</a> for more details (here related to Solr, but in general showcasing the topic of search query injections).
      impact: If this risk remains unmitigated, attackers might be able to read more data from the search index and eventually further escalate towards a deeper system penetration via code executions.
      asvs: V5 - Validation, Sanitization and Encoding Verification Requirements
      cheat_sheet: https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html
      action: Search-Query Injection Prevention
      mitigation: Try to use libraries that properly encode search query meta characters in searches and don't expose the query unfiltered to the caller. When a third-party product is used instead of custom developed software, check if the product applies the proper mitigation and ensure a reasonable patch-level.
      check: Are recommendations from the linked cheat sheet and referenced ASVS chapter applied?
      function: development
      stride: tampering
      detection_logic: In-scope clients accessing search engine servers via typical search access protocols.
      risk_assessment: The risk rating depends on the sensitivity of the search engine server itself and of the data assets processed.
      false_positives: Server engine queries by search values not consisting of parts controllable by the caller can be considered as false positives after individual review.
      cwe: 74
risk_tracking:
    container-baseimage-backdooring@admin:
        synthetic_risk_id: container-baseimage-backdooring@admin
        justification: We use trusted base images and perform regular vuln scans. We should also implement signature validation
        status: mitigated
    container-baseimage-backdooring@admin-nginx:
        synthetic_risk_id: container-baseimage-backdooring@admin-nginx
        justification: We use trusted base images and perform regular vuln scans. We should also implement signature validation
        status: mitigated
    container-baseimage-backdooring@consul-kv:
        synthetic_risk_id: container-baseimage-backdooring@consul-kv
        justification: We use trusted base images and perform regular vuln scans. We should also implement signature validation
        status: mitigated
    container-baseimage-backdooring@encryption-service:
        synthetic_risk_id: container-baseimage-backdooring@encryption-service
        justification: We use trusted base images and perform regular vuln scans. We should also implement signature validation
        status: mitigated
    container-baseimage-backdooring@encryption-service-nginx:
        synthetic_risk_id: container-baseimage-backdooring@encryption-service-nginx
        justification: We use trusted base images and perform regular vuln scans. We should also implement signature validation
        status: mitigated
    container-baseimage-backdooring@idp:
        synthetic_risk_id: container-baseimage-backdooring@idp
        justification: We use trusted base images and perform regular vuln scans. We should also implement signature validation
        status: mitigated
    container-baseimage-backdooring@idp-nginx:
        synthetic_risk_id: container-baseimage-backdooring@idp-nginx
        justification: We use trusted base images and perform regular vuln scans. We should also implement signature validation
        status: mitigated
    container-baseimage-backdooring@vault:
        synthetic_risk_id: container-baseimage-backdooring@vault
        justification: We use trusted base images and perform regular vuln scans. We should also implement signature validation
        status: mitigated
    container-platform-escape@nomad:
        synthetic_risk_id: container-platform-escape@nomad
        justification: Select a tool for Nomad to perform this check
    cross-site-request-forgery@admin@admin-nginx>admin-access:
        synthetic_risk_id: cross-site-request-forgery@admin@admin-nginx>admin-access
        justification: Validation via SAST, DAST; Mitigation via WAF
        status: mitigated
    cross-site-request-forgery@idp@idp-nginx>idp-member-access:
        synthetic_risk_id: cross-site-request-forgery@idp@idp-nginx>idp-member-access
        justification: Validation via SAST, DAST; Mitigation via WAF
        status: mitigated
    cross-site-request-forgery@idp@idp-nginx>idp-partner-access:
        synthetic_risk_id: cross-site-request-forgery@idp@idp-nginx>idp-partner-access
        justification: Validation via SAST, DAST; Mitigation via WAF
        status: mitigated
    cross-site-scripting@admin:
        synthetic_risk_id: cross-site-scripting@admin
        justification: Validation via SAST, DAST; Mitigation via WAF
        status: mitigated
    cross-site-scripting@idp:
        synthetic_risk_id: cross-site-scripting@idp
        justification: Validation via SAST, DAST; Mitigation via WAF
        status: mitigated
    dos-risky-access-across-trust-boundary@idp@ha-proxy-lb@ha-proxy-lb>idp-app-access->idp-nginx>idp-member-access:
        synthetic_risk_id: dos-risky-access-across-trust-boundary@idp@ha-proxy-lb@ha-proxy-lb>idp-app-access->idp-nginx>idp-member-access
        justification: Discuss with the network team
    dos-risky-access-across-trust-boundary@idp@ha-proxy-lb@ha-proxy-lb>idp-app-access->idp-nginx>idp-partner-access:
        synthetic_risk_id: dos-risky-access-across-trust-boundary@idp@ha-proxy-lb@ha-proxy-lb>idp-app-access->idp-nginx>idp-partner-access
        justification: Discuss with the network team
    missing-authentication-second-factor@admin-nginx>admin-access@admin-nginx@admin:
        synthetic_risk_id: missing-authentication-second-factor@admin-nginx>admin-access@admin-nginx@admin
        status: false-positive
    missing-cloud-hardening@admin-boundary@gcp:
        synthetic_risk_id: missing-cloud-hardening@admin-boundary@gcp
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@admin-runtime@gcp:
        synthetic_risk_id: missing-cloud-hardening@admin-runtime@gcp
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@artifactory-boundary@gcp:
        synthetic_risk_id: missing-cloud-hardening@artifactory-boundary@gcp
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@aws@aws:
        synthetic_risk_id: missing-cloud-hardening@aws@aws
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@cd-boundary@gcp:
        synthetic_risk_id: missing-cloud-hardening@cd-boundary@gcp
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@ci-boundary@gcp:
        synthetic_risk_id: missing-cloud-hardening@ci-boundary@gcp
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@core-db-boundary@gcp:
        synthetic_risk_id: missing-cloud-hardening@core-db-boundary@gcp
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@encryption-service-boundary@gcp:
        synthetic_risk_id: missing-cloud-hardening@encryption-service-boundary@gcp
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@encryption-service-runtime@gcp:
        synthetic_risk_id: missing-cloud-hardening@encryption-service-runtime@gcp
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@gcp-core@gcp:
        synthetic_risk_id: missing-cloud-hardening@gcp-core@gcp
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@gcp-dmz@gcp:
        synthetic_risk_id: missing-cloud-hardening@gcp-dmz@gcp
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@gcp@gcp:
        synthetic_risk_id: missing-cloud-hardening@gcp@gcp
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@idp-boundary@gcp:
        synthetic_risk_id: missing-cloud-hardening@idp-boundary@gcp
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@idp-runtime@gcp:
        synthetic_risk_id: missing-cloud-hardening@idp-runtime@gcp
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@idp@s3:
        synthetic_risk_id: missing-cloud-hardening@idp@s3
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@log-boundary@gcp:
        synthetic_risk_id: missing-cloud-hardening@log-boundary@gcp
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@metrics-boundary@gcp:
        synthetic_risk_id: missing-cloud-hardening@metrics-boundary@gcp
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@redis-boundary@gcp:
        synthetic_risk_id: missing-cloud-hardening@redis-boundary@gcp
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@scan-boundary@gcp:
        synthetic_risk_id: missing-cloud-hardening@scan-boundary@gcp
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-cloud-hardening@vault-boundary@gcp:
        synthetic_risk_id: missing-cloud-hardening@vault-boundary@gcp
        justification: Tool to scan for cloud misconfiguration issues is being considered
        status: in-discussion
    missing-hardening@core-db:
        synthetic_risk_id: missing-hardening@core-db
        justification: Hardening guides should be defined and applied
    missing-hardening@idp:
        synthetic_risk_id: missing-hardening@idp
        justification: Hardening guides should be defined and applied
    missing-hardening@redis:
        synthetic_risk_id: missing-hardening@redis
        justification: Hardening guides should be defined and applied
    missing-hardening@vault:
        synthetic_risk_id: missing-hardening@vault
        justification: Hardening guides should be defined and applied
    server-side-request-forgery@harness@github@harness>harness-github-access:
        synthetic_risk_id: server-side-request-forgery@harness@github@harness>harness-github-access
        justification: No custom-developed parts
        status: false-positive
    server-side-request-forgery@harness@nomad@harness>harness-nomad-processing:
        synthetic_risk_id: server-side-request-forgery@harness@nomad@harness>harness-nomad-processing
        justification: No custom-developed parts
        status: false-positive
    server-side-request-forgery@idp@encryption-service-nginx@idp>encryption-service-app-access:
        synthetic_risk_id: server-side-request-forgery@idp@encryption-service-nginx@idp>encryption-service-app-access
        justification: Perform input validation on all data that is passed to internal services; use static analysis (such as semgrep)
    server-side-request-forgery@idp@grafana@idp>grafana-log-push:
        synthetic_risk_id: server-side-request-forgery@idp@grafana@idp>grafana-log-push
        justification: Perform input validation on all data that is passed to internal services; use static analysis (such as semgrep)
    server-side-request-forgery@idp@honeycomb@idp>honeycomb-log-push:
        synthetic_risk_id: server-side-request-forgery@idp@honeycomb@idp>honeycomb-log-push
        justification: Perform input validation on all data that is passed to internal services; use static analysis (such as semgrep)
    server-side-request-forgery@idp@postmark@idp>postmark:
        synthetic_risk_id: server-side-request-forgery@idp@postmark@idp>postmark
        justification: Perform input validation on all data that is passed to internal services; use static analysis (such as semgrep)
    server-side-request-forgery@idp@prove@idp>prove:
        synthetic_risk_id: server-side-request-forgery@idp@prove@idp>prove
        justification: Perform input validation on all data that is passed to internal services; use static analysis (such as semgrep)
    server-side-request-forgery@idp@ses@idp>ses-access:
        synthetic_risk_id: server-side-request-forgery@idp@ses@idp>ses-access
        justification: Perform input validation on all data that is passed to internal services; use static analysis (such as semgrep)
    server-side-request-forgery@idp@sns@idp>sns-access:
        synthetic_risk_id: server-side-request-forgery@idp@sns@idp>sns-access
        justification: Perform input validation on all data that is passed to internal services; use static analysis (such as semgrep)
    server-side-request-forgery@idp@splunk@idp>splunk-log-push:
        synthetic_risk_id: server-side-request-forgery@idp@splunk@idp>splunk-log-push
        justification: Perform input validation on all data that is passed to internal services; use static analysis (such as semgrep)
    server-side-request-forgery@idp@telesign@idp>telesign:
        synthetic_risk_id: server-side-request-forgery@idp@telesign@idp>telesign
        justification: Perform input validation on all data that is passed to internal services; use static analysis (such as semgrep)
    server-side-request-forgery@idp@vault@idp>idp-vault-access:
        synthetic_risk_id: server-side-request-forgery@idp@vault@idp>idp-vault-access
        justification: Perform input validation on all data that is passed to internal services; use static analysis (such as semgrep)
    server-side-request-forgery@nomad@consul-kv@nomad>nomad-value-pull:
        synthetic_risk_id: server-side-request-forgery@nomad@consul-kv@nomad>nomad-value-pull
        justification: No custom-developed parts
        status: false-positive
    server-side-request-forgery@nomad@vault@nomad>nomad-secret-pull:
        synthetic_risk_id: server-side-request-forgery@nomad@vault@nomad>nomad-secret-pull
        justification: No custom-developed parts
        status: false-positive
    sql-nosql-injection@admin@core-db@admin>core-db-access:
        synthetic_risk_id: sql-nosql-injection@admin@core-db@admin>core-db-access
        justification: Validation via SAST, DAST; Mitigation via WAF
        status: mitigated
    sql-nosql-injection@idp@core-db@idp>core-db-access:
        synthetic_risk_id: sql-nosql-injection@idp@core-db@idp>core-db-access
        justification: Validation via SAST, DAST; Mitigation via WAF
        status: mitigated
    unchecked-deployment@artifactory:
        synthetic_risk_id: unchecked-deployment@artifactory
        justification: Vuln scanning using tenable should be implemented
    unchecked-deployment@git-client:
        synthetic_risk_id: unchecked-deployment@git-client
        justification: Vuln scanning using tenable should be implemented
    unchecked-deployment@github:
        synthetic_risk_id: unchecked-deployment@github
        justification: Vuln scanning using tenable should be implemented
    unchecked-deployment@github-workers:
        synthetic_risk_id: unchecked-deployment@github-workers
        justification: Vuln scanning using tenable should be implemented
    unchecked-deployment@snyk:
        synthetic_risk_id: unchecked-deployment@snyk
        justification: Vuln scanning using tenable should be implemented
    unchecked-deployment@tenable-scan-host:
        synthetic_risk_id: unchecked-deployment@tenable-scan-host
        justification: Vuln scanning using tenable
        status: mitigated
    unencrypted-asset@consul-kv:
        synthetic_risk_id: unencrypted-asset@consul-kv
        justification: Data stored here is only sensitive so it shouldnt require encryption at rest
        status: accepted
    unencrypted-asset@idp:
        synthetic_risk_id: unencrypted-asset@idp
        justification: Creds should not be stored locally unencrypted
    unencrypted-asset@redis:
        synthetic_risk_id: unencrypted-asset@redis
        justification: Sensitive data should be encrypted
    unnecessary-communication-link@dev-ops-browser>harness-client-access@dev-ops-browser:
        synthetic_risk_id: unnecessary-communication-link@dev-ops-browser>harness-client-access@dev-ops-browser
        justification: Link has been added for clarity but does not convey any data assets
        status: false-positive
    untrusted-deserialization@admin:
        synthetic_risk_id: untrusted-deserialization@admin
        justification: Implement vuln scanning and management of dependencies
    untrusted-deserialization@idp:
        synthetic_risk_id: untrusted-deserialization@idp
        justification: Implement vuln scanning and management of dependencies
communication_links:
    admin-nginx>admin-access:
        id: admin-nginx>admin-access
        source_id: admin-nginx
        target_id: admin
        title: Admin access
        description: Admin access
        protocol: https
        vpn: true
        authentication: two-factor
        authorization: end-user-identity-propagation
        usage: devops
        data_assets_sent:
            - feature-flags
            - configuration
        data_assets_received:
            - feature-flags
            - configuration
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    admin>core-db-access:
        id: admin>core-db-access
        source_id: admin
        target_id: core-db
        title: Core DB access
        description: Core DB access
        protocol: sql-access-protocol-encrypted
        ip_filtered: true
        authentication: credentials
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - user-account
            - idp-consumer-credentials
        data_assets_received:
            - user-account
            - idp-consumer-credentials
        diagram_tweak_weight: 3
        diagram_tweak_constraint: true
    admin>redis-access:
        id: admin>redis-access
        source_id: admin
        target_id: redis
        title: Redis access
        description: Redis access
        protocol: binary-encrypted
        readonly: true
        authentication: credentials
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - user-session
        data_assets_received:
            - user-session
        diagram_tweak_weight: 3
        diagram_tweak_constraint: true
    akamai-reverse-proxy>waf-access:
        id: akamai-reverse-proxy>waf-access
        source_id: akamai-reverse-proxy
        target_id: akamai-waf
        title: WAF access
        description: WAF access
        protocol: https
        data_assets_sent:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
        data_assets_received:
            - user-account
            - user-session
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    akamai-waf>ha-lb-access:
        id: akamai-waf>ha-lb-access
        source_id: akamai-waf
        target_id: ha-proxy-lb
        title: HA LB access
        description: HA LB access
        protocol: https
        readonly: true
        data_assets_sent:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
        data_assets_received:
            - user-account
            - user-session
        diagram_tweak_weight: 3
        diagram_tweak_constraint: true
    dev-ops-browser>admin-app-access:
        id: dev-ops-browser>admin-app-access
        source_id: dev-ops-browser
        target_id: admin-nginx
        title: Admin app access
        description: Admin app access
        protocol: https
        readonly: true
        usage: devops
        data_assets_sent:
            - feature-flags
            - configuration
        data_assets_received:
            - feature-flags
            - configuration
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    dev-ops-browser>grafana-admin-user-access:
        id: dev-ops-browser>grafana-admin-user-access
        source_id: dev-ops-browser
        target_id: grafana
        title: Grafana admin user access
        description: Grafana admin user access
        protocol: https
        vpn: true
        readonly: true
        authentication: credentials
        authorization: end-user-identity-propagation
        usage: devops
        data_assets_received:
            - application-logs
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    dev-ops-browser>harness-client-access:
        id: dev-ops-browser>harness-client-access
        source_id: dev-ops-browser
        target_id: harness
        title: Harness client access
        description: Harness client access
        protocol: https
        readonly: true
        authentication: credentials
        authorization: end-user-identity-propagation
        usage: devops
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    dev-ops-browser>honeycomb-admin-user-access:
        id: dev-ops-browser>honeycomb-admin-user-access
        source_id: dev-ops-browser
        target_id: honeycomb
        title: Honeycomb admin user access
        description: Honeycomb admin user access
        protocol: https
        readonly: true
        authentication: credentials
        authorization: end-user-identity-propagation
        usage: devops
        data_assets_received:
            - application-traces
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    dev-ops-browser>snyk-client-access:
        id: dev-ops-browser>snyk-client-access
        source_id: dev-ops-browser
        target_id: snyk
        title: Snyk client access
        description: Snyk client access
        protocol: https
        readonly: true
        authentication: credentials
        authorization: end-user-identity-propagation
        usage: devops
        data_assets_received:
            - security-scan-results
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    dev-ops-browser>splunk-admin-user-access:
        id: dev-ops-browser>splunk-admin-user-access
        source_id: dev-ops-browser
        target_id: splunk
        title: Splunk admin user access
        description: Splunk admin user access
        protocol: https
        vpn: true
        readonly: true
        authentication: credentials
        authorization: end-user-identity-propagation
        usage: devops
        data_assets_received:
            - application-logs
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    dev-ops-browser>tenable-client-access:
        id: dev-ops-browser>tenable-client-access
        source_id: dev-ops-browser
        target_id: tenable
        title: Tenable client access
        description: Tenable client access
        protocol: https
        readonly: true
        authentication: credentials
        authorization: end-user-identity-propagation
        usage: devops
        data_assets_received:
            - security-scan-results
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    encryption-service-nginx>encryption-service-access:
        id: encryption-service-nginx>encryption-service-access
        source_id: encryption-service-nginx
        target_id: encryption-service
        title: Encryption Service access
        description: Encryption Service access
        protocol: https
        readonly: true
        authentication: credentials
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - user-account
        data_assets_received:
            - user-account
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    git-client>github-git-client-access:
        id: git-client>github-git-client-access
        source_id: git-client
        target_id: github
        title: Github git client access
        description: Github git client access
        protocol: ssh
        authentication: two-factor
        authorization: end-user-identity-propagation
        usage: devops
        data_assets_sent:
            - source-code
        data_assets_received:
            - source-code
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    github-workers>github-tool-access:
        id: github-workers>github-tool-access
        source_id: github-workers
        target_id: github
        title: Github tool access
        description: Github tool access
        protocol: https
        readonly: true
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_received:
            - source-code
            - configuration
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    github-workers>github-worker-artifactory-access:
        id: github-workers>github-worker-artifactory-access
        source_id: github-workers
        target_id: artifactory
        title: Github Worker Artifactory Access
        description: Github Worker Artifactory Access
        protocol: https
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - app-dependency-packages
        data_assets_received:
            - app-dependency-packages
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    ha-proxy-lb>idp-app-access:
        id: ha-proxy-lb>idp-app-access
        source_id: ha-proxy-lb
        target_id: idp-nginx
        title: IDP app access
        description: IDP app access
        protocol: https
        readonly: true
        data_assets_sent:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
        data_assets_received:
            - user-account
            - user-session
        diagram_tweak_weight: 3
        diagram_tweak_constraint: true
    harness>harness-github-access:
        id: harness>harness-github-access
        source_id: harness
        target_id: github
        title: Harness Github access
        description: Harness Github access
        protocol: https
        readonly: true
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_received:
            - configuration-template
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    harness>harness-nomad-processing:
        id: harness>harness-nomad-processing
        source_id: harness
        target_id: nomad
        title: Harness Nomad processing
        description: Harness Nomad processing
        protocol: https
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - configuration-template
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    idp-nginx>idp-member-access:
        id: idp-nginx>idp-member-access
        source_id: idp-nginx
        target_id: idp
        title: IDP Member Access
        description: IDP Member Access
        protocol: https
        authentication: two-factor
        authorization: end-user-identity-propagation
        data_assets_sent:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
        data_assets_received:
            - user-account
            - user-session
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    idp-nginx>idp-partner-access:
        id: idp-nginx>idp-partner-access
        source_id: idp-nginx
        target_id: idp
        title: IDP Partner Access
        description: IDP Partner Access
        protocol: https
        authentication: credentials
        authorization: end-user-identity-propagation
        data_assets_sent:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
        data_assets_received:
            - user-account
            - user-session
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    idp>core-db-access:
        id: idp>core-db-access
        source_id: idp
        target_id: core-db
        title: Core DB access
        description: Core DB access
        protocol: sql-access-protocol-encrypted
        ip_filtered: true
        authentication: credentials
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - user-account
            - idp-consumer-credentials
        data_assets_received:
            - user-account
            - idp-consumer-credentials
        diagram_tweak_weight: 3
        diagram_tweak_constraint: true
    idp>encryption-service-app-access:
        id: idp>encryption-service-app-access
        source_id: idp
        target_id: encryption-service-nginx
        title: Encryption Service app access
        description: Encryption Service app access
        protocol: https
        readonly: true
        usage: devops
        data_assets_sent:
            - user-account
        data_assets_received:
            - user-account
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    idp>grafana-log-push:
        id: idp>grafana-log-push
        source_id: idp
        target_id: grafana
        title: Grafana Log Push
        description: Grafana Log Push
        protocol: https
        authentication: credentials
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - application-metrics
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    idp>honeycomb-log-push:
        id: idp>honeycomb-log-push
        source_id: idp
        target_id: honeycomb
        title: Honeycomb Log Push
        description: Honeycomb Log Push
        protocol: https
        authentication: credentials
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - application-traces
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    idp>idp-vault-access:
        id: idp>idp-vault-access
        source_id: idp
        target_id: vault
        title: IDP Vault Access
        description: IDP Vault Access
        protocol: https
        readonly: true
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - developer-ssh-keys
        data_assets_received:
            - developer-ssh-keys
        diagram_tweak_weight: 3
        diagram_tweak_constraint: true
    idp>postmark:
        id: idp>postmark
        source_id: idp
        target_id: postmark
        title: Postmark
        description: Postmark
        protocol: https
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - authenticator
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    idp>prove:
        id: idp>prove
        source_id: idp
        target_id: prove
        title: Prove
        description: Prove
        protocol: https
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - authenticator
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    idp>redis-access:
        id: idp>redis-access
        source_id: idp
        target_id: redis
        title: Redis access
        description: Redis access
        protocol: binary-encrypted
        readonly: true
        authentication: credentials
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - user-session
        data_assets_received:
            - user-session
        diagram_tweak_weight: 3
        diagram_tweak_constraint: true
    idp>ses-access:
        id: idp>ses-access
        source_id: idp
        target_id: ses
        title: SES access
        description: SES access
        protocol: https
        authentication: credentials
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - authenticator
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    idp>sns-access:
        id: idp>sns-access
        source_id: idp
        target_id: sns
        title: SNS access
        description: SNS access
        protocol: https
        authentication: credentials
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - application-logs
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    idp>splunk-log-push:
        id: idp>splunk-log-push
        source_id: idp
        target_id: splunk
        title: Splunk Log Push
        description: Splunk Log Push
        protocol: https
        authentication: credentials
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - application-logs
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    idp>telesign:
        id: idp>telesign
        source_id: idp
        target_id: telesign
        title: Telesign
        description: Telesign
        protocol: https
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - authenticator
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    member-browser>reverse-proxy-access:
        id: member-browser>reverse-proxy-access
        source_id: member-browser
        target_id: akamai-reverse-proxy
        title: reverse proxy access
        description: reverse proxy access
        protocol: https
        ip_filtered: true
        readonly: true
        data_assets_sent:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
        data_assets_received:
            - user-account
            - user-session
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    nomad>nomad-secret-pull:
        id: nomad>nomad-secret-pull
        source_id: nomad
        target_id: vault
        title: Nomad secret pull
        description: Nomad secret pull
        protocol: https
        readonly: true
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_received:
            - configuration-secrets
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    nomad>nomad-value-pull:
        id: nomad>nomad-value-pull
        source_id: nomad
        target_id: consul-kv
        title: Nomad value pull
        description: Nomad value pull
        protocol: https
        readonly: true
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_received:
            - configuration-values
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    partner-consumer-application>reverse-proxy-access:
        id: partner-consumer-application>reverse-proxy-access
        source_id: partner-consumer-application
        target_id: akamai-reverse-proxy
        title: reverse proxy access
        description: reverse proxy access
        protocol: https
        ip_filtered: true
        readonly: true
        data_assets_sent:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
        data_assets_received:
            - user-account
            - user-session
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    snyk>github-tool-access:
        id: snyk>github-tool-access
        source_id: snyk
        target_id: github
        title: Github tool access
        description: Github tool access
        protocol: https
        readonly: true
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_received:
            - source-code
            - configuration
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    tenable>tenable-scan:
        id: tenable>tenable-scan
        source_id: tenable
        target_id: tenable-scan-host
        title: Tenable Scan
        description: Tenable Scan
        protocol: ssh
        readonly: true
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - security-scan-results
        data_assets_received:
            - security-scan-results
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    terraform>github-tool-access:
        id: terraform>github-tool-access
        source_id: terraform
        target_id: github
        title: Github tool access
        description: Github tool access
        protocol: https
        readonly: true
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_received:
            - source-code
            - configuration
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    terraform>terraform-configurator-akamai-reverse-proxy:
        id: terraform>terraform-configurator-akamai-reverse-proxy
        source_id: terraform
        target_id: akamai-reverse-proxy
        title: Terraform Configurator -> akamai-reverse-proxy
        description: Terraform Configurator -> akamai-reverse-proxy
        protocol: https
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - configuration
        data_assets_received:
            - configuration
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    terraform>terraform-configurator-akamai-waf:
        id: terraform>terraform-configurator-akamai-waf
        source_id: terraform
        target_id: akamai-waf
        title: Terraform Configurator -> akamai-waf
        description: Terraform Configurator -> akamai-waf
        protocol: https
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - configuration
        data_assets_received:
            - configuration
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    terraform>terraform-configurator-artifactory:
        id: terraform>terraform-configurator-artifactory
        source_id: terraform
        target_id: artifactory
        title: Terraform Configurator -> artifactory
        description: Terraform Configurator -> artifactory
        protocol: https
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - configuration
        data_assets_received:
            - configuration
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    terraform>terraform-configurator-github:
        id: terraform>terraform-configurator-github
        source_id: terraform
        target_id: github
        title: Terraform Configurator -> github
        description: Terraform Configurator -> github
        protocol: https
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - configuration
        data_assets_received:
            - configuration
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    terraform>terraform-configurator-vault:
        id: terraform>terraform-configurator-vault
        source_id: terraform
        target_id: vault
        title: Terraform Configurator -> vault
        description: Terraform Configurator -> vault
        protocol: https
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - configuration
        data_assets_received:
            - configuration
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    terraform>terraform-infra-manager-artifactory:
        id: terraform>terraform-infra-manager-artifactory
        source_id: terraform
        target_id: artifactory
        title: Terraform Infra Manager -> artifactory
        description: Terraform Infra Manager -> artifactory
        protocol: https
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - configuration
        data_assets_received:
            - configuration
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    terraform>terraform-infra-manager-github-workers:
        id: terraform>terraform-infra-manager-github-workers
        source_id: terraform
        target_id: github-workers
        title: Terraform Infra Manager -> github-workers
        description: Terraform Infra Manager -> github-workers
        protocol: https
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - configuration
        data_assets_received:
            - configuration
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    terraform>terraform-infra-manager-grafana:
        id: terraform>terraform-infra-manager-grafana
        source_id: terraform
        target_id: grafana
        title: Terraform Infra Manager -> grafana
        description: Terraform Infra Manager -> grafana
        protocol: https
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - configuration
        data_assets_received:
            - configuration
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    terraform>terraform-infra-manager-splunk:
        id: terraform>terraform-infra-manager-splunk
        source_id: terraform
        target_id: splunk
        title: Terraform Infra Manager -> splunk
        description: Terraform Infra Manager -> splunk
        protocol: https
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - configuration
        data_assets_received:
            - configuration
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    terraform>terraform-infra-manager-tenable-scan-host:
        id: terraform>terraform-infra-manager-tenable-scan-host
        source_id: terraform
        target_id: tenable-scan-host
        title: Terraform Infra Manager -> tenable-scan-host
        description: Terraform Infra Manager -> tenable-scan-host
        protocol: https
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - configuration
        data_assets_received:
            - configuration
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    terraform>terraform-infra-manager-vault:
        id: terraform>terraform-infra-manager-vault
        source_id: terraform
        target_id: vault
        title: Terraform Infra Manager -> vault
        description: Terraform Infra Manager -> vault
        protocol: https
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - configuration
        data_assets_received:
            - configuration
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
    terraform>terraform-vault-access:
        id: terraform>terraform-vault-access
        source_id: terraform
        target_id: vault
        title: Terraform Vault Access
        description: Terraform Vault Access
        protocol: https
        readonly: true
        authentication: token
        authorization: technical-user
        usage: devops
        data_assets_sent:
            - developer-ssh-keys
        data_assets_received:
            - developer-ssh-keys
        diagram_tweak_weight: 1
        diagram_tweak_constraint: true
diagram_tweak_nodesep: 2
diagram_tweak_ranksep: 2
incoming_technical_communication_links_mapped_by_target_id:
    admin:
        - id: admin-nginx>admin-access
          source_id: admin-nginx
          target_id: admin
          title: Admin access
          description: Admin access
          protocol: https
          vpn: true
          authentication: two-factor
          authorization: end-user-identity-propagation
          usage: devops
          data_assets_sent:
            - feature-flags
            - configuration
          data_assets_received:
            - feature-flags
            - configuration
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    admin-nginx:
        - id: dev-ops-browser>admin-app-access
          source_id: dev-ops-browser
          target_id: admin-nginx
          title: Admin app access
          description: Admin app access
          protocol: https
          readonly: true
          usage: devops
          data_assets_sent:
            - feature-flags
            - configuration
          data_assets_received:
            - feature-flags
            - configuration
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    akamai-reverse-proxy:
        - id: member-browser>reverse-proxy-access
          source_id: member-browser
          target_id: akamai-reverse-proxy
          title: reverse proxy access
          description: reverse proxy access
          protocol: https
          ip_filtered: true
          readonly: true
          data_assets_sent:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
          data_assets_received:
            - user-account
            - user-session
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: partner-consumer-application>reverse-proxy-access
          source_id: partner-consumer-application
          target_id: akamai-reverse-proxy
          title: reverse proxy access
          description: reverse proxy access
          protocol: https
          ip_filtered: true
          readonly: true
          data_assets_sent:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
          data_assets_received:
            - user-account
            - user-session
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: terraform>terraform-configurator-akamai-reverse-proxy
          source_id: terraform
          target_id: akamai-reverse-proxy
          title: Terraform Configurator -> akamai-reverse-proxy
          description: Terraform Configurator -> akamai-reverse-proxy
          protocol: https
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - configuration
          data_assets_received:
            - configuration
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    akamai-waf:
        - id: akamai-reverse-proxy>waf-access
          source_id: akamai-reverse-proxy
          target_id: akamai-waf
          title: WAF access
          description: WAF access
          protocol: https
          data_assets_sent:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
          data_assets_received:
            - user-account
            - user-session
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: terraform>terraform-configurator-akamai-waf
          source_id: terraform
          target_id: akamai-waf
          title: Terraform Configurator -> akamai-waf
          description: Terraform Configurator -> akamai-waf
          protocol: https
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - configuration
          data_assets_received:
            - configuration
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    artifactory:
        - id: github-workers>github-worker-artifactory-access
          source_id: github-workers
          target_id: artifactory
          title: Github Worker Artifactory Access
          description: Github Worker Artifactory Access
          protocol: https
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - app-dependency-packages
          data_assets_received:
            - app-dependency-packages
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: terraform>terraform-configurator-artifactory
          source_id: terraform
          target_id: artifactory
          title: Terraform Configurator -> artifactory
          description: Terraform Configurator -> artifactory
          protocol: https
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - configuration
          data_assets_received:
            - configuration
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: terraform>terraform-infra-manager-artifactory
          source_id: terraform
          target_id: artifactory
          title: Terraform Infra Manager -> artifactory
          description: Terraform Infra Manager -> artifactory
          protocol: https
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - configuration
          data_assets_received:
            - configuration
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    consul-kv:
        - id: nomad>nomad-value-pull
          source_id: nomad
          target_id: consul-kv
          title: Nomad value pull
          description: Nomad value pull
          protocol: https
          readonly: true
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_received:
            - configuration-values
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    core-db:
        - id: admin>core-db-access
          source_id: admin
          target_id: core-db
          title: Core DB access
          description: Core DB access
          protocol: sql-access-protocol-encrypted
          ip_filtered: true
          authentication: credentials
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - user-account
            - idp-consumer-credentials
          data_assets_received:
            - user-account
            - idp-consumer-credentials
          diagram_tweak_weight: 3
          diagram_tweak_constraint: true
        - id: idp>core-db-access
          source_id: idp
          target_id: core-db
          title: Core DB access
          description: Core DB access
          protocol: sql-access-protocol-encrypted
          ip_filtered: true
          authentication: credentials
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - user-account
            - idp-consumer-credentials
          data_assets_received:
            - user-account
            - idp-consumer-credentials
          diagram_tweak_weight: 3
          diagram_tweak_constraint: true
    encryption-service:
        - id: encryption-service-nginx>encryption-service-access
          source_id: encryption-service-nginx
          target_id: encryption-service
          title: Encryption Service access
          description: Encryption Service access
          protocol: https
          readonly: true
          authentication: credentials
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - user-account
          data_assets_received:
            - user-account
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    encryption-service-nginx:
        - id: idp>encryption-service-app-access
          source_id: idp
          target_id: encryption-service-nginx
          title: Encryption Service app access
          description: Encryption Service app access
          protocol: https
          readonly: true
          usage: devops
          data_assets_sent:
            - user-account
          data_assets_received:
            - user-account
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    github:
        - id: git-client>github-git-client-access
          source_id: git-client
          target_id: github
          title: Github git client access
          description: Github git client access
          protocol: ssh
          authentication: two-factor
          authorization: end-user-identity-propagation
          usage: devops
          data_assets_sent:
            - source-code
          data_assets_received:
            - source-code
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: harness>harness-github-access
          source_id: harness
          target_id: github
          title: Harness Github access
          description: Harness Github access
          protocol: https
          readonly: true
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_received:
            - configuration-template
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: github-workers>github-tool-access
          source_id: github-workers
          target_id: github
          title: Github tool access
          description: Github tool access
          protocol: https
          readonly: true
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_received:
            - source-code
            - configuration
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: terraform>github-tool-access
          source_id: terraform
          target_id: github
          title: Github tool access
          description: Github tool access
          protocol: https
          readonly: true
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_received:
            - source-code
            - configuration
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: terraform>terraform-configurator-github
          source_id: terraform
          target_id: github
          title: Terraform Configurator -> github
          description: Terraform Configurator -> github
          protocol: https
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - configuration
          data_assets_received:
            - configuration
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: snyk>github-tool-access
          source_id: snyk
          target_id: github
          title: Github tool access
          description: Github tool access
          protocol: https
          readonly: true
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_received:
            - source-code
            - configuration
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    github-workers:
        - id: terraform>terraform-infra-manager-github-workers
          source_id: terraform
          target_id: github-workers
          title: Terraform Infra Manager -> github-workers
          description: Terraform Infra Manager -> github-workers
          protocol: https
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - configuration
          data_assets_received:
            - configuration
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    grafana:
        - id: dev-ops-browser>grafana-admin-user-access
          source_id: dev-ops-browser
          target_id: grafana
          title: Grafana admin user access
          description: Grafana admin user access
          protocol: https
          vpn: true
          readonly: true
          authentication: credentials
          authorization: end-user-identity-propagation
          usage: devops
          data_assets_received:
            - application-logs
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: idp>grafana-log-push
          source_id: idp
          target_id: grafana
          title: Grafana Log Push
          description: Grafana Log Push
          protocol: https
          authentication: credentials
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - application-metrics
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: terraform>terraform-infra-manager-grafana
          source_id: terraform
          target_id: grafana
          title: Terraform Infra Manager -> grafana
          description: Terraform Infra Manager -> grafana
          protocol: https
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - configuration
          data_assets_received:
            - configuration
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    ha-proxy-lb:
        - id: akamai-waf>ha-lb-access
          source_id: akamai-waf
          target_id: ha-proxy-lb
          title: HA LB access
          description: HA LB access
          protocol: https
          readonly: true
          data_assets_sent:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
          data_assets_received:
            - user-account
            - user-session
          diagram_tweak_weight: 3
          diagram_tweak_constraint: true
    harness:
        - id: dev-ops-browser>harness-client-access
          source_id: dev-ops-browser
          target_id: harness
          title: Harness client access
          description: Harness client access
          protocol: https
          readonly: true
          authentication: credentials
          authorization: end-user-identity-propagation
          usage: devops
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    honeycomb:
        - id: dev-ops-browser>honeycomb-admin-user-access
          source_id: dev-ops-browser
          target_id: honeycomb
          title: Honeycomb admin user access
          description: Honeycomb admin user access
          protocol: https
          readonly: true
          authentication: credentials
          authorization: end-user-identity-propagation
          usage: devops
          data_assets_received:
            - application-traces
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: idp>honeycomb-log-push
          source_id: idp
          target_id: honeycomb
          title: Honeycomb Log Push
          description: Honeycomb Log Push
          protocol: https
          authentication: credentials
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - application-traces
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    idp:
        - id: idp-nginx>idp-member-access
          source_id: idp-nginx
          target_id: idp
          title: IDP Member Access
          description: IDP Member Access
          protocol: https
          authentication: two-factor
          authorization: end-user-identity-propagation
          data_assets_sent:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
          data_assets_received:
            - user-account
            - user-session
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: idp-nginx>idp-partner-access
          source_id: idp-nginx
          target_id: idp
          title: IDP Partner Access
          description: IDP Partner Access
          protocol: https
          authentication: credentials
          authorization: end-user-identity-propagation
          data_assets_sent:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
          data_assets_received:
            - user-account
            - user-session
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    idp-nginx:
        - id: ha-proxy-lb>idp-app-access
          source_id: ha-proxy-lb
          target_id: idp-nginx
          title: IDP app access
          description: IDP app access
          protocol: https
          readonly: true
          data_assets_sent:
            - user-account
            - user-session
            - authenticator
            - idp-consumer-credentials
          data_assets_received:
            - user-account
            - user-session
          diagram_tweak_weight: 3
          diagram_tweak_constraint: true
    nomad:
        - id: harness>harness-nomad-processing
          source_id: harness
          target_id: nomad
          title: Harness Nomad processing
          description: Harness Nomad processing
          protocol: https
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - configuration-template
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    postmark:
        - id: idp>postmark
          source_id: idp
          target_id: postmark
          title: Postmark
          description: Postmark
          protocol: https
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - authenticator
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    prove:
        - id: idp>prove
          source_id: idp
          target_id: prove
          title: Prove
          description: Prove
          protocol: https
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - authenticator
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    redis:
        - id: admin>redis-access
          source_id: admin
          target_id: redis
          title: Redis access
          description: Redis access
          protocol: binary-encrypted
          readonly: true
          authentication: credentials
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - user-session
          data_assets_received:
            - user-session
          diagram_tweak_weight: 3
          diagram_tweak_constraint: true
        - id: idp>redis-access
          source_id: idp
          target_id: redis
          title: Redis access
          description: Redis access
          protocol: binary-encrypted
          readonly: true
          authentication: credentials
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - user-session
          data_assets_received:
            - user-session
          diagram_tweak_weight: 3
          diagram_tweak_constraint: true
    ses:
        - id: idp>ses-access
          source_id: idp
          target_id: ses
          title: SES access
          description: SES access
          protocol: https
          authentication: credentials
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - authenticator
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    sns:
        - id: idp>sns-access
          source_id: idp
          target_id: sns
          title: SNS access
          description: SNS access
          protocol: https
          authentication: credentials
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - application-logs
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    snyk:
        - id: dev-ops-browser>snyk-client-access
          source_id: dev-ops-browser
          target_id: snyk
          title: Snyk client access
          description: Snyk client access
          protocol: https
          readonly: true
          authentication: credentials
          authorization: end-user-identity-propagation
          usage: devops
          data_assets_received:
            - security-scan-results
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    splunk:
        - id: dev-ops-browser>splunk-admin-user-access
          source_id: dev-ops-browser
          target_id: splunk
          title: Splunk admin user access
          description: Splunk admin user access
          protocol: https
          vpn: true
          readonly: true
          authentication: credentials
          authorization: end-user-identity-propagation
          usage: devops
          data_assets_received:
            - application-logs
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: idp>splunk-log-push
          source_id: idp
          target_id: splunk
          title: Splunk Log Push
          description: Splunk Log Push
          protocol: https
          authentication: credentials
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - application-logs
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: terraform>terraform-infra-manager-splunk
          source_id: terraform
          target_id: splunk
          title: Terraform Infra Manager -> splunk
          description: Terraform Infra Manager -> splunk
          protocol: https
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - configuration
          data_assets_received:
            - configuration
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    telesign:
        - id: idp>telesign
          source_id: idp
          target_id: telesign
          title: Telesign
          description: Telesign
          protocol: https
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - authenticator
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    tenable:
        - id: dev-ops-browser>tenable-client-access
          source_id: dev-ops-browser
          target_id: tenable
          title: Tenable client access
          description: Tenable client access
          protocol: https
          readonly: true
          authentication: credentials
          authorization: end-user-identity-propagation
          usage: devops
          data_assets_received:
            - security-scan-results
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    tenable-scan-host:
        - id: tenable>tenable-scan
          source_id: tenable
          target_id: tenable-scan-host
          title: Tenable Scan
          description: Tenable Scan
          protocol: ssh
          readonly: true
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - security-scan-results
          data_assets_received:
            - security-scan-results
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: terraform>terraform-infra-manager-tenable-scan-host
          source_id: terraform
          target_id: tenable-scan-host
          title: Terraform Infra Manager -> tenable-scan-host
          description: Terraform Infra Manager -> tenable-scan-host
          protocol: https
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - configuration
          data_assets_received:
            - configuration
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
    vault:
        - id: nomad>nomad-secret-pull
          source_id: nomad
          target_id: vault
          title: Nomad secret pull
          description: Nomad secret pull
          protocol: https
          readonly: true
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_received:
            - configuration-secrets
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: idp>idp-vault-access
          source_id: idp
          target_id: vault
          title: IDP Vault Access
          description: IDP Vault Access
          protocol: https
          readonly: true
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - developer-ssh-keys
          data_assets_received:
            - developer-ssh-keys
          diagram_tweak_weight: 3
          diagram_tweak_constraint: true
        - id: terraform>terraform-configurator-vault
          source_id: terraform
          target_id: vault
          title: Terraform Configurator -> vault
          description: Terraform Configurator -> vault
          protocol: https
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - configuration
          data_assets_received:
            - configuration
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: terraform>terraform-infra-manager-vault
          source_id: terraform
          target_id: vault
          title: Terraform Infra Manager -> vault
          description: Terraform Infra Manager -> vault
          protocol: https
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - configuration
          data_assets_received:
            - configuration
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
        - id: terraform>terraform-vault-access
          source_id: terraform
          target_id: vault
          title: Terraform Vault Access
          description: Terraform Vault Access
          protocol: https
          readonly: true
          authentication: token
          authorization: technical-user
          usage: devops
          data_assets_sent:
            - developer-ssh-keys
          data_assets_received:
            - developer-ssh-keys
          diagram_tweak_weight: 1
          diagram_tweak_constraint: true
direct_containing_trust_boundary_mapped_by_technical_asset_id:
    admin:
        id: admin-runtime
        title: Admin Runtime
        description: Admin Runtime
        type: execution-environment
        tags:
            - gcp
        technical_assets_inside:
            - admin-nginx
            - admin
    admin-nginx:
        id: admin-runtime
        title: Admin Runtime
        description: Admin Runtime
        type: execution-environment
        tags:
            - gcp
        technical_assets_inside:
            - admin-nginx
            - admin
    akamai-reverse-proxy:
        id: akamai
        title: Akamai
        description: Akamai
        type: network-dedicated-hoster
        technical_assets_inside:
            - akamai-reverse-proxy
            - akamai-waf
    akamai-waf:
        id: akamai
        title: Akamai
        description: Akamai
        type: network-dedicated-hoster
        technical_assets_inside:
            - akamai-reverse-proxy
            - akamai-waf
    artifactory:
        id: artifactory-boundary
        title: Artifactory Boundary
        description: Artifactory Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - artifactory
    consul-kv:
        id: cd-boundary
        title: CD Boundary
        description: CD Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - terraform
            - consul-kv
            - nomad
            - harness
    core-db:
        id: core-db-boundary
        title: Core DB Boundary
        description: Core DB Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - core-db
    dev-ops-browser:
        id: id-me-laptop
        title: ID.me laptop
        description: ID.me laptop
        type: execution-environment
        technical_assets_inside:
            - git-client
            - dev-ops-browser
    encryption-service:
        id: encryption-service-runtime
        title: Encryption Service Runtime
        description: Encryption Service Runtime
        type: execution-environment
        tags:
            - gcp
        technical_assets_inside:
            - encryption-service-nginx
            - encryption-service
    encryption-service-nginx:
        id: encryption-service-runtime
        title: Encryption Service Runtime
        description: Encryption Service Runtime
        type: execution-environment
        tags:
            - gcp
        technical_assets_inside:
            - encryption-service-nginx
            - encryption-service
    git-client:
        id: id-me-laptop
        title: ID.me laptop
        description: ID.me laptop
        type: execution-environment
        technical_assets_inside:
            - git-client
            - dev-ops-browser
    github-workers:
        id: ci-boundary
        title: CI Boundary
        description: CI Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - github-workers
    grafana:
        id: metrics-boundary
        title: Metrics Boundary
        description: Metrics Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - grafana
    ha-proxy-lb:
        id: gcp-dmz
        title: GCP DMZ
        description: GCP DMZ
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - ha-proxy-lb
    harness:
        id: cd-boundary
        title: CD Boundary
        description: CD Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - terraform
            - consul-kv
            - nomad
            - harness
    idp:
        id: idp-runtime
        title: IDP Runtime
        description: IDP Runtime
        type: execution-environment
        tags:
            - gcp
        technical_assets_inside:
            - idp-nginx
            - idp
    idp-nginx:
        id: idp-runtime
        title: IDP Runtime
        description: IDP Runtime
        type: execution-environment
        tags:
            - gcp
        technical_assets_inside:
            - idp-nginx
            - idp
    nomad:
        id: cd-boundary
        title: CD Boundary
        description: CD Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - terraform
            - consul-kv
            - nomad
            - harness
    redis:
        id: redis-boundary
        title: Redis Boundary
        description: Redis Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - redis
    ses:
        id: aws
        title: AWS
        description: AWS
        type: network-cloud-provider
        tags:
            - aws
        technical_assets_inside:
            - sns
            - ses
            - tenable
    sns:
        id: aws
        title: AWS
        description: AWS
        type: network-cloud-provider
        tags:
            - aws
        technical_assets_inside:
            - sns
            - ses
            - tenable
    splunk:
        id: log-boundary
        title: Log Boundary
        description: Log Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - splunk
    tenable:
        id: aws
        title: AWS
        description: AWS
        type: network-cloud-provider
        tags:
            - aws
        technical_assets_inside:
            - sns
            - ses
            - tenable
    tenable-scan-host:
        id: scan-boundary
        title: Scan Boundary
        description: Scan Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - tenable-scan-host
    terraform:
        id: cd-boundary
        title: CD Boundary
        description: CD Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - terraform
            - consul-kv
            - nomad
            - harness
    vault:
        id: vault-boundary
        title: Vault Boundary
        description: Vault Boundary
        type: network-cloud-security-group
        tags:
            - gcp
        technical_assets_inside:
            - vault
